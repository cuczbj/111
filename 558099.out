| distributed init (rank 0)
DATALOADER:
  batch_size: 64
  crop: False
  data_aug_color: True
  data_aug_shift: True
  datapath: /seu_share/home/huangjie/220235144/spatial-relation-benchmark-main/data/spatialsense/annots_spatialsenseplus.json
  dataset_name: spatialsense
  load_img: True
  norm_data: True
  num_workers: 4
  object_dim: 3679
  predicate_dim: 9
  resize_mask: False
  trans_vec: []
EXP:
  EXP_ID: spatialsenseplus_RegionViT_seed0
  MODEL_NAME: regionvit
  OUTPUT_DIR: ./results
  SEED: 0
MODEL:
  CNNTRANSFORMER:
    backbone: resnet50
    pretrained_resnet: 
    prompt_emb_pool: max
    roi_pool_size: 3
    use_attn_mask: True
  CROSSATTNVIT:
    decoder_attn_drop_rate: 0.0
    decoder_depth: 1
    decoder_drop_rate: 0.0
    emb_pool: max-in-roi
  REGIONVIT:
    backbone: vit_base
    box_feature_size: 128
    hidden_dim: 512
    pretrain_ckp: ./data/pretrained_checkpoints/ibot_vit_base_patch16.pth
  RELATIVIT:
    prompt_emb_pool: max-in-roi
    use_attn_mask: True
  VISION_TRANSFORMER:
    depth: 12
    drop_path_rate: 0.0
    drop_rate: 0.0
    embed_dim: 768
    in_chans: 3
    num_heads: 12
    patch_size: 16
    pretrained: 
    readnet_d_hidden: 512
    readnet_dropout: 0.0
TRAIN:
  early_stop: 20
  l2: 0.0001
  layer_decay: 0.75
  learning_rate: 0.0001
  lr_decay_ratio: 0.5
  num_epochs: 100
  optimizer: adamw
  patience: 10
  scheduler: cosine
  warmup: 5
5346 relations in train
808 relations in valid
1236 relations in test
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding grid-size from %s to %s [14, 14] (14, 14)
Loading ViT pretrained weights from ./data/pretrained_checkpoints/ibot_vit_base_patch16.pth.
missing keys: []
unexpected keys: ['cls_token', 'masked_embed']
vit Backbone frozen!
Assigned values = [0.023757264018058777, 0.03167635202407837, 0.04223513603210449, 0.056313514709472656, 0.07508468627929688, 0.1001129150390625, 0.13348388671875, 0.177978515625, 0.2373046875, 0.31640625, 0.421875, 0.5625, 0.75, 1.0]
Param groups = {
  "layer_13_decay": {
    "weight_decay": 0.0001,
    "params": [
      "subject_feature_extractor.fc.0.weight",
      "rel_classifier.0.weight",
      "rel_classifier.3.weight"
    ],
    "lr_scale": 1.0
  },
  "layer_13_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "subject_feature_extractor.fc.0.bias",
      "subject_feature_extractor.fc.2.weight",
      "subject_feature_extractor.fc.2.bias",
      "rel_classifier.0.bias",
      "rel_classifier.2.weight",
      "rel_classifier.2.bias",
      "rel_classifier.3.bias"
    ],
    "lr_scale": 1.0
  }
}
DistributedDataParallel(
  (module): RegionViT(
    (backbone): VitModel(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
        (norm): Identity()
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (blocks): Sequential(
        (0): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (1): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (2): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (3): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (4): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (5): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (6): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (7): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (8): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (9): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (10): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (11): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (pre_logits): None
      (head): None
    )
    (subject_feature_extractor): RoiBoxFeatureExtractor(
      (pooler): RoIAlign(output_size=(3, 3), spatial_scale=0.0625, sampling_ratio=-1, aligned=False)
      (fc): Sequential(
        (0): Linear(in_features=6912, out_features=128, bias=True)
        (1): ReLU()
        (2): SyncBatchNorm(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (rel_classifier): Sequential(
      (0): Linear(in_features=128, out_features=512, bias=True)
      (1): ReLU()
      (2): SyncBatchNorm(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (3): Linear(in_features=512, out_features=9, bias=True)
    )
  )
)

Epoch #0
Training..
[0/84] Loss = 0.70, Forward time = 1.08, Backward time = 0.00, Data loading time = 3.59
[50/84] Loss = 0.73, Forward time = 11.73, Backward time = 0.07, Data loading time = 23.49
Train, acc avg: 0.5061389515238858 acc: 0.5035540591096147, pre: 0.4922319041597881, rec: 0.4971297359357061, f1: 0.49466369687020034, loss: 0.7310148371117455, lr: 0
{'next to': 0.518, 'to the right of': 0.525, 'behind': 0.487, 'in front of': 0.511, 'above': 0.556, 'in': 0.496, 'under': 0.498, 'on': 0.503, 'to the left of': 0.46}

Validating..
Valid, acc avg: 0.47907245693492306 acc: 0.4777227722772277, pre: 0.47738692267872057, rec: 0.47029702970297027, f1: 0.47381045577131475, loss: 0.7412343621253967
{'above': 0.406, 'on': 0.472, 'behind': 0.463, 'in': 0.486, 'in front of': 0.561, 'to the right of': 0.417, 'to the left of': 0.537, 'next to': 0.45, 'under': 0.519}

Testing..
Test, acc avg: 0.5090386283451548 acc: 0.511326860841424, pre: 0.5111464886760113, rec: 0.5194174757281553, f1: 0.5152437923830215, loss: 0.731920599937439
{'above': 0.557, 'behind': 0.528, 'in': 0.467, 'to the right of': 0.529, 'to the left of': 0.434, 'on': 0.559, 'under': 0.493, 'next to': 0.526, 'in front of': 0.488}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed0/model_best.pth

Epoch #1
Training..
[0/84] Loss = 0.72, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.56
[50/84] Loss = 0.70, Forward time = 10.96, Backward time = 0.07, Data loading time = 14.91
Train, acc avg: 0.5563078256602751 acc: 0.5635989524878414, pre: 0.5510576201639036, rec: 0.5782625334864141, f1: 0.5643274015184768, loss: 0.688826465180942, lr: 2e-05
{'in front of': 0.548, 'to the left of': 0.571, 'behind': 0.593, 'under': 0.584, 'to the right of': 0.62, 'next to': 0.548, 'on': 0.517, 'above': 0.53, 'in': 0.496}

Validating..
Valid, acc avg: 0.5607280786481329 acc: 0.5457920792079208, pre: 0.5419501010895669, rec: 0.5915841584158416, f1: 0.5656754763088666, loss: 0.6996913552284241
{'above': 0.479, 'on': 0.506, 'behind': 0.537, 'in': 0.514, 'in front of': 0.524, 'to the right of': 0.617, 'to the left of': 0.741, 'next to': 0.562, 'under': 0.567}

Testing..
Test, acc avg: 0.558229565362986 acc: 0.5622977346278317, pre: 0.5570370287846367, rec: 0.6084142394822006, f1: 0.5815881993837906, loss: 0.6924460530281067
{'above': 0.528, 'behind': 0.57, 'in': 0.489, 'to the right of': 0.618, 'to the left of': 0.654, 'on': 0.569, 'under': 0.571, 'next to': 0.5, 'in front of': 0.524}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed0/model_best.pth

Epoch #2
Training..
[0/84] Loss = 0.58, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.59
[50/84] Loss = 0.61, Forward time = 11.05, Backward time = 0.08, Data loading time = 15.10
Train, acc avg: 0.6725815422600614 acc: 0.676954732510288, pre: 0.6560958398305291, rec: 0.7125908916953693, f1: 0.6831724059444974, loss: 0.6046060231469926, lr: 4e-05
{'to the right of': 0.725, 'under': 0.701, 'to the left of': 0.763, 'on': 0.649, 'in': 0.567, 'behind': 0.673, 'next to': 0.643, 'in front of': 0.643, 'above': 0.69}

Validating..
Valid, acc avg: 0.6037687106962175 acc: 0.5903465346534653, pre: 0.5805739386186769, rec: 0.650990099009901, f1: 0.6137639707178099, loss: 0.6751909852027893
{'above': 0.573, 'on': 0.545, 'behind': 0.634, 'in': 0.486, 'in front of': 0.561, 'to the right of': 0.733, 'to the left of': 0.759, 'next to': 0.487, 'under': 0.654}

Testing..
Test, acc avg: 0.5854186740321573 acc: 0.5889967637540453, pre: 0.5794797604121422, rec: 0.6488673139158576, f1: 0.6122087517799881, loss: 0.6749207973480225
{'above': 0.566, 'behind': 0.641, 'in': 0.511, 'to the right of': 0.662, 'to the left of': 0.713, 'on': 0.578, 'under': 0.529, 'next to': 0.509, 'in front of': 0.56}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed0/model_best.pth

Epoch #3
Training..
[0/84] Loss = 0.57, Forward time = 0.21, Backward time = 0.00, Data loading time = 1.64
[50/84] Loss = 0.53, Forward time = 11.09, Backward time = 0.07, Data loading time = 14.96
Train, acc avg: 0.754371201391006 acc: 0.7532734754956977, pre: 0.7268583424724462, rec: 0.7933409873708381, f1: 0.7586409368442263, loss: 0.5352314519030708, lr: 6.000000000000001e-05
{'in': 0.729, 'on': 0.739, 'behind': 0.743, 'in front of': 0.721, 'to the left of': 0.775, 'next to': 0.771, 'above': 0.769, 'under': 0.753, 'to the right of': 0.79}

Validating..
Valid, acc avg: 0.6233461416388244 acc: 0.6076732673267327, pre: 0.5960264769089079, rec: 0.6683168316831684, f1: 0.6301000265354766, loss: 0.6640585064888
{'above': 0.583, 'on': 0.562, 'behind': 0.744, 'in': 0.541, 'in front of': 0.524, 'to the right of': 0.7, 'to the left of': 0.833, 'next to': 0.487, 'under': 0.635}

Testing..
Test, acc avg: 0.6047297484252436 acc: 0.6092233009708737, pre: 0.5982532664009714, rec: 0.6650485436893204, f1: 0.6298800666620991, loss: 0.671142578125
{'above': 0.642, 'behind': 0.641, 'in': 0.533, 'to the right of': 0.662, 'to the left of': 0.721, 'on': 0.647, 'under': 0.55, 'next to': 0.5, 'in front of': 0.548}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed0/model_best.pth

Epoch #4
Training..
[0/84] Loss = 0.44, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.59
[50/84] Loss = 0.47, Forward time = 11.13, Backward time = 0.07, Data loading time = 14.93
Train, acc avg: 0.8073657946561107 acc: 0.8022820800598578, pre: 0.7766714054883662, rec: 0.835820895522388, f1: 0.8051562955972347, loss: 0.4707918851858094, lr: 8e-05
{'in front of': 0.76, 'under': 0.79, 'in': 0.804, 'to the left of': 0.847, 'on': 0.802, 'behind': 0.791, 'to the right of': 0.821, 'next to': 0.823, 'above': 0.828}

Validating..
Valid, acc avg: 0.6314363426998928 acc: 0.6150990099009901, pre: 0.6044943684383288, rec: 0.6658415841584159, f1: 0.6336816944597857, loss: 0.6808255314826965
{'above': 0.573, 'on': 0.58, 'behind': 0.671, 'in': 0.608, 'in front of': 0.573, 'to the right of': 0.683, 'to the left of': 0.852, 'next to': 0.537, 'under': 0.606}

Testing..
Test, acc avg: 0.6188074165480106 acc: 0.6189320388349514, pre: 0.60729926120731, rec: 0.6731391585760518, f1: 0.6385214857184339, loss: 0.6738649606704712
{'above': 0.642, 'behind': 0.634, 'in': 0.565, 'to the right of': 0.713, 'to the left of': 0.735, 'on': 0.588, 'under': 0.579, 'next to': 0.535, 'in front of': 0.578}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed0/model_best.pth

Epoch #5
Training..
[0/84] Loss = 0.43, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.63
[50/84] Loss = 0.41, Forward time = 11.16, Backward time = 0.07, Data loading time = 15.17
Train, acc avg: 0.8473739554848441 acc: 0.8417508417508418, pre: 0.8206896521935039, rec: 0.8652889399158056, f1: 0.8423944058339716, loss: 0.4151313432625362, lr: 9.938441702975689e-05
{'to the left of': 0.861, 'to the right of': 0.84, 'behind': 0.819, 'next to': 0.861, 'in front of': 0.815, 'in': 0.842, 'on': 0.84, 'under': 0.838, 'above': 0.91}

Validating..
Valid, acc avg: 0.6084792566838638 acc: 0.594059405940594, pre: 0.5863636230371905, rec: 0.6386138613861386, f1: 0.611369409476744, loss: 0.6817604303359985
{'above': 0.562, 'on': 0.557, 'behind': 0.646, 'in': 0.554, 'in front of': 0.537, 'to the right of': 0.683, 'to the left of': 0.796, 'next to': 0.525, 'under': 0.615}

Testing..
Test, acc avg: 0.6198032016547427 acc: 0.6197411003236246, pre: 0.6091445337884287, rec: 0.6682847896440129, f1: 0.6373406848503504, loss: 0.680721640586853
{'above': 0.651, 'behind': 0.641, 'in': 0.587, 'to the right of': 0.654, 'to the left of': 0.699, 'on': 0.603, 'under': 0.621, 'next to': 0.544, 'in front of': 0.578}

Epoch #6
Training..
[0/84] Loss = 0.36, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.56
[50/84] Loss = 0.35, Forward time = 11.21, Backward time = 0.07, Data loading time = 14.71
Train, acc avg: 0.8876698914357407 acc: 0.8830901608679387, pre: 0.8689680739830434, rec: 0.8959050899349407, f1: 0.8822260151704285, loss: 0.35107132153851645, lr: 9.911436253643445e-05
{'in front of': 0.846, 'next to': 0.901, 'in': 0.896, 'behind': 0.875, 'under': 0.88, 'to the left of': 0.893, 'above': 0.925, 'on': 0.887, 'to the right of': 0.887}

Validating..
Valid, acc avg: 0.6363010315923595 acc: 0.6188118811881188, pre: 0.6057268589046948, rec: 0.6806930693069307, f1: 0.6410206505731336, loss: 0.687195897102356
{'above': 0.604, 'on': 0.562, 'behind': 0.695, 'in': 0.595, 'in front of': 0.549, 'to the right of': 0.75, 'to the left of': 0.815, 'next to': 0.512, 'under': 0.644}

Testing..
Test, acc avg: 0.6193522084986782 acc: 0.6173139158576052, pre: 0.605224954931423, rec: 0.6747572815533981, f1: 0.6380975347777396, loss: 0.689953088760376
{'above': 0.613, 'behind': 0.676, 'in': 0.652, 'to the right of': 0.654, 'to the left of': 0.684, 'on': 0.583, 'under': 0.586, 'next to': 0.535, 'in front of': 0.59}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed0/model_best.pth

Epoch #7
Training..
[0/84] Loss = 0.28, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.55
[50/84] Loss = 0.29, Forward time = 11.20, Backward time = 0.07, Data loading time = 14.67
Train, acc avg: 0.9098490639260499 acc: 0.9042274597830153, pre: 0.8877814658996623, rec: 0.9203980099502488, f1: 0.9037905655331757, loss: 0.30393522037636667, lr: 9.879583809693738e-05
{'to the right of': 0.914, 'under': 0.879, 'to the left of': 0.899, 'in front of': 0.893, 'behind': 0.892, 'on': 0.914, 'next to': 0.937, 'above': 0.948, 'in': 0.912}

Validating..
Valid, acc avg: 0.6351315509513341 acc: 0.6175742574257426, pre: 0.6096997549722921, rec: 0.6534653465346535, f1: 0.630819371264929, loss: 0.717822253704071
{'above': 0.562, 'on': 0.574, 'behind': 0.707, 'in': 0.622, 'in front of': 0.549, 'to the right of': 0.7, 'to the left of': 0.87, 'next to': 0.487, 'under': 0.644}

Testing..
Test, acc avg: 0.6154456866440507 acc: 0.6148867313915858, pre: 0.6079027263236668, rec: 0.6472491909385113, f1: 0.6269542476887016, loss: 0.7104697823524475
{'above': 0.613, 'behind': 0.662, 'in': 0.62, 'to the right of': 0.603, 'to the left of': 0.735, 'on': 0.588, 'under': 0.607, 'next to': 0.526, 'in front of': 0.584}

Epoch #8
Training..
[0/84] Loss = 0.27, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.55
[50/84] Loss = 0.25, Forward time = 11.22, Backward time = 0.07, Data loading time = 14.67
Train, acc avg: 0.9267568268108383 acc: 0.9214365881032548, pre: 0.908379884884991, rec: 0.9334098737083811, f1: 0.9207198010247197, loss: 0.2608532463865621, lr: 9.842915805643155e-05
{'in': 0.933, 'under': 0.894, 'behind': 0.921, 'in front of': 0.916, 'to the right of': 0.922, 'to the left of': 0.918, 'on': 0.928, 'above': 0.959, 'next to': 0.949}

Validating..
Valid, acc avg: 0.6092101427806035 acc: 0.5965346534653465, pre: 0.5906976606814498, rec: 0.6287128712871287, f1: 0.6091077074290134, loss: 0.7312331795692444
{'above': 0.521, 'on': 0.574, 'behind': 0.732, 'in': 0.554, 'in front of': 0.537, 'to the right of': 0.667, 'to the left of': 0.796, 'next to': 0.487, 'under': 0.615}

Testing..
Test, acc avg: 0.59908103424648 acc: 0.6003236245954693, pre: 0.5950920154126992, rec: 0.627831715210356, f1: 0.6110186208604996, loss: 0.7420929074287415
{'above': 0.594, 'behind': 0.634, 'in': 0.543, 'to the right of': 0.676, 'to the left of': 0.713, 'on': 0.564, 'under': 0.55, 'next to': 0.526, 'in front of': 0.59}

Epoch #9
Training..
[0/84] Loss = 0.23, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.59
[50/84] Loss = 0.22, Forward time = 11.23, Backward time = 0.08, Data loading time = 14.65
Train, acc avg: 0.9379430144536448 acc: 0.9313505424616536, pre: 0.9279725574391289, rec: 0.9318790662074244, f1: 0.9299167091764552, loss: 0.2299994295906453, lr: 9.801468428384716e-05
{'under': 0.901, 'in front of': 0.914, 'in': 0.963, 'to the right of': 0.937, 'to the left of': 0.935, 'on': 0.945, 'next to': 0.952, 'above': 0.955, 'behind': 0.94}

Validating..
Valid, acc avg: 0.6370314946534459 acc: 0.6274752475247525, pre: 0.6211764559723187, rec: 0.6534653465346535, f1: 0.6369069376637058, loss: 0.7566283345222473
{'above': 0.604, 'on': 0.602, 'behind': 0.695, 'in': 0.581, 'in front of': 0.5, 'to the right of': 0.65, 'to the left of': 0.833, 'next to': 0.575, 'under': 0.692}

Testing..
Test, acc avg: 0.6157155940653847 acc: 0.6132686084142395, pre: 0.604790410107928, rec: 0.6537216828478964, f1: 0.6282998238631665, loss: 0.7606347799301147
{'above': 0.66, 'behind': 0.634, 'in': 0.609, 'to the right of': 0.676, 'to the left of': 0.691, 'on': 0.574, 'under': 0.557, 'next to': 0.544, 'in front of': 0.596}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed0/model_best.pth

Epoch #10
Training..
[0/84] Loss = 0.21, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.57
[50/84] Loss = 0.19, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.93
Train, acc avg: 0.9509301462827637 acc: 0.945379723157501, pre: 0.9407519903503532, rec: 0.9479525449674704, f1: 0.9443335419513407, loss: 0.2008852202977453, lr: 9.755282581475769e-05
{'in': 0.958, 'in front of': 0.927, 'behind': 0.948, 'next to': 0.97, 'to the left of': 0.943, 'under': 0.918, 'to the right of': 0.96, 'above': 0.974, 'on': 0.96}

Validating..
Valid, acc avg: 0.6130866869010501 acc: 0.6039603960396039, pre: 0.5990565896448918, rec: 0.6287128712871287, f1: 0.6135215655964922, loss: 0.7550927996635437
{'above': 0.583, 'on': 0.585, 'behind': 0.659, 'in': 0.541, 'in front of': 0.5, 'to the right of': 0.65, 'to the left of': 0.796, 'next to': 0.55, 'under': 0.654}

Testing..
Test, acc avg: 0.6041495219397751 acc: 0.6067961165048543, pre: 0.5999999909090911, rec: 0.6407766990291263, f1: 0.619713310450448, loss: 0.7613101005554199
{'above': 0.623, 'behind': 0.662, 'in': 0.533, 'to the right of': 0.684, 'to the left of': 0.699, 'on': 0.603, 'under': 0.521, 'next to': 0.535, 'in front of': 0.578}

Epoch #11
Training..
[0/84] Loss = 0.21, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.63
[50/84] Loss = 0.17, Forward time = 11.28, Backward time = 0.06, Data loading time = 14.74
Train, acc avg: 0.9566996776472779 acc: 0.9511784511784511, pre: 0.9485125821948414, rec: 0.9517795637198623, f1: 0.950138264701752, loss: 0.18019310322900614, lr: 9.704403844771128e-05
{'behind': 0.948, 'on': 0.954, 'in front of': 0.931, 'to the left of': 0.96, 'next to': 0.982, 'in': 0.983, 'above': 0.974, 'under': 0.931, 'to the right of': 0.947}

Validating..
Valid, acc avg: 0.6262430352538754 acc: 0.6163366336633663, pre: 0.6082949168595642, rec: 0.6534653465346535, f1: 0.6300665979742012, loss: 0.7734166979789734
{'above': 0.562, 'on': 0.602, 'behind': 0.683, 'in': 0.568, 'in front of': 0.512, 'to the right of': 0.683, 'to the left of': 0.815, 'next to': 0.537, 'under': 0.673}

Testing..
Test, acc avg: 0.6025296157518683 acc: 0.6011326860841424, pre: 0.593423010561689, rec: 0.6423948220064725, f1: 0.6169336200369085, loss: 0.8030733466148376
{'above': 0.632, 'behind': 0.613, 'in': 0.576, 'to the right of': 0.691, 'to the left of': 0.699, 'on': 0.578, 'under': 0.536, 'next to': 0.544, 'in front of': 0.554}

Epoch #12
Training..
[0/84] Loss = 0.16, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.62
[50/84] Loss = 0.15, Forward time = 11.25, Backward time = 0.06, Data loading time = 14.62
Train, acc avg: 0.9659538280743085 acc: 0.9612794612794613, pre: 0.9595110734930822, rec: 0.961347110600842, f1: 0.9604232145967839, loss: 0.15512676856347493, lr: 9.648882429441257e-05
{'next to': 0.979, 'under': 0.941, 'in front of': 0.958, 'behind': 0.951, 'above': 0.978, 'on': 0.971, 'to the right of': 0.958, 'in': 0.983, 'to the left of': 0.975}

Validating..
Valid, acc avg: 0.6121577811110331 acc: 0.6002475247524752, pre: 0.5926773319753471, rec: 0.6410891089108911, f1: 0.6159284130191852, loss: 0.7976471185684204
{'above': 0.552, 'on': 0.574, 'behind': 0.646, 'in': 0.595, 'in front of': 0.512, 'to the right of': 0.683, 'to the left of': 0.778, 'next to': 0.525, 'under': 0.644}

Testing..
Test, acc avg: 0.6016053324577103 acc: 0.6019417475728155, pre: 0.5945945856667479, rec: 0.6407766990291263, f1: 0.6168174321305585, loss: 0.811431348323822
{'above': 0.623, 'behind': 0.648, 'in': 0.554, 'to the right of': 0.632, 'to the left of': 0.728, 'on': 0.574, 'under': 0.557, 'next to': 0.526, 'in front of': 0.572}

Epoch #13
Training..
[0/84] Loss = 0.11, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.64
[50/84] Loss = 0.14, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.97
Train, acc avg: 0.9627829385491664 acc: 0.9597830153385709, pre: 0.9576335841311695, rec: 0.9601990049751243, f1: 0.9589095787491116, loss: 0.1462147447857119, lr: 9.588773128419906e-05
{'behind': 0.966, 'to the right of': 0.956, 'above': 0.978, 'next to': 0.978, 'under': 0.943, 'in front of': 0.951, 'to the left of': 0.954, 'in': 0.971, 'on': 0.969}

Validating..
Valid, acc avg: 0.6214282293550587 acc: 0.6064356435643564, pre: 0.5995370231588653, rec: 0.6410891089108911, f1: 0.6196122231178002, loss: 0.7970532774925232
{'above': 0.562, 'on': 0.562, 'behind': 0.671, 'in': 0.581, 'in front of': 0.512, 'to the right of': 0.667, 'to the left of': 0.833, 'next to': 0.55, 'under': 0.654}

Testing..
Test, acc avg: 0.5952816090685986 acc: 0.5970873786407767, pre: 0.5914634056179359, rec: 0.627831715210356, f1: 0.6091001802420231, loss: 0.8326107859611511
{'above': 0.651, 'behind': 0.69, 'in': 0.489, 'to the right of': 0.669, 'to the left of': 0.684, 'on': 0.564, 'under': 0.5, 'next to': 0.526, 'in front of': 0.584}

Epoch #14
Training..
[0/84] Loss = 0.12, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.65
[50/84] Loss = 0.13, Forward time = 11.25, Backward time = 0.07, Data loading time = 14.85
Train, acc avg: 0.9701431933193858 acc: 0.9665170220725776, pre: 0.9684372557027049, rec: 0.9628779181017987, f1: 0.9656445856254652, loss: 0.1343236237409569, lr: 9.524135262330098e-05
{'on': 0.96, 'next to': 0.99, 'to the left of': 0.962, 'under': 0.95, 'behind': 0.963, 'in front of': 0.961, 'in': 0.975, 'above': 0.993, 'to the right of': 0.977}

Validating..
Valid, acc avg: 0.6271671625668915 acc: 0.6163366336633663, pre: 0.6093023114115742, rec: 0.6485148514851485, f1: 0.6282923594759082, loss: 0.8133748769760132
{'above': 0.562, 'on': 0.608, 'behind': 0.683, 'in': 0.568, 'in front of': 0.512, 'to the right of': 0.733, 'to the left of': 0.796, 'next to': 0.537, 'under': 0.644}

Testing..
Test, acc avg: 0.6127660898688168 acc: 0.6140776699029126, pre: 0.6038291516372732, rec: 0.6634304207119741, f1: 0.6322232251915372, loss: 0.8530820608139038
{'above': 0.604, 'behind': 0.627, 'in': 0.565, 'to the right of': 0.684, 'to the left of': 0.757, 'on': 0.593, 'under': 0.571, 'next to': 0.535, 'in front of': 0.578}

Epoch #15
Training..
[0/84] Loss = 0.12, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.54
[50/84] Loss = 0.12, Forward time = 11.25, Backward time = 0.07, Data loading time = 14.78
Train, acc avg: 0.9732976894822437 acc: 0.9691358024691358, pre: 0.9693251496574955, rec: 0.967470340604669, f1: 0.968391857014893, loss: 0.1201199513993093, lr: 9.45503262094184e-05
{'to the right of': 0.968, 'on': 0.981, 'under': 0.951, 'next to': 0.988, 'above': 0.981, 'in': 0.996, 'behind': 0.956, 'to the left of': 0.966, 'in front of': 0.972}

Validating..
Valid, acc avg: 0.6185063676256088 acc: 0.6101485148514851, pre: 0.6009070158524487, rec: 0.655940594059406, f1: 0.6272139371147429, loss: 0.8510007858276367
{'above': 0.583, 'on': 0.608, 'behind': 0.659, 'in': 0.568, 'in front of': 0.488, 'to the right of': 0.683, 'to the left of': 0.796, 'next to': 0.537, 'under': 0.644}

Testing..
Test, acc avg: 0.6085060545851732 acc: 0.6092233009708737, pre: 0.6008968520045314, rec: 0.6504854368932039, f1: 0.6247036277460409, loss: 0.8660910725593567
{'above': 0.642, 'behind': 0.62, 'in': 0.587, 'to the right of': 0.654, 'to the left of': 0.691, 'on': 0.608, 'under': 0.564, 'next to': 0.526, 'in front of': 0.584}

Epoch #16
Training..
[0/84] Loss = 0.08, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.55
[50/84] Loss = 0.11, Forward time = 11.26, Backward time = 0.07, Data loading time = 15.02
Train, acc avg: 0.971136354997996 acc: 0.9696969696969697, pre: 0.9657924706735367, rec: 0.9724454649827784, f1: 0.9691025497240893, loss: 0.11431477626874334, lr: 9.381533400219318e-05
{'next to': 0.99, 'in': 0.988, 'behind': 0.963, 'on': 0.969, 'in front of': 0.966, 'under': 0.963, 'to the left of': 0.975, 'above': 0.97, 'to the right of': 0.956}

Validating..
Valid, acc avg: 0.628322469972199 acc: 0.6212871287128713, pre: 0.616113729475978, rec: 0.6435643564356436, f1: 0.6295349463663827, loss: 0.8362019658088684
{'above': 0.531, 'on': 0.619, 'behind': 0.671, 'in': 0.608, 'in front of': 0.524, 'to the right of': 0.65, 'to the left of': 0.796, 'next to': 0.562, 'under': 0.692}

Testing..
Test, acc avg: 0.6135225856546013 acc: 0.6148867313915858, pre: 0.6069277017028961, rec: 0.6521035598705501, f1: 0.6287001497788832, loss: 0.8659843802452087
{'above': 0.651, 'behind': 0.627, 'in': 0.554, 'to the right of': 0.706, 'to the left of': 0.706, 'on': 0.593, 'under': 0.55, 'next to': 0.526, 'in front of': 0.608}

Epoch #17
Training..
[0/84] Loss = 0.13, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.55
[50/84] Loss = 0.10, Forward time = 11.25, Backward time = 0.06, Data loading time = 14.74
Train, acc avg: 0.9762398252215172 acc: 0.9715675271230827, pre: 0.9705544895963498, rec: 0.9712973593570609, f1: 0.9709207824080298, loss: 0.10376917996576854, lr: 9.30371013501972e-05
{'in front of': 0.962, 'to the left of': 0.983, 'behind': 0.965, 'on': 0.985, 'above': 0.985, 'under': 0.949, 'in': 0.988, 'to the right of': 0.981, 'next to': 0.989}

Validating..
Valid, acc avg: 0.6184636985280617 acc: 0.6064356435643564, pre: 0.5981735023248059, rec: 0.6485148514851485, f1: 0.6223227917755917, loss: 0.8500412702560425
{'above': 0.552, 'on': 0.585, 'behind': 0.646, 'in': 0.581, 'in front of': 0.512, 'to the right of': 0.683, 'to the left of': 0.796, 'next to': 0.575, 'under': 0.635}

Testing..
Test, acc avg: 0.6074925928072958 acc: 0.6084142394822006, pre: 0.6012084501328029, rec: 0.6440129449838188, f1: 0.6218700010899131, loss: 0.8912204504013062
{'above': 0.66, 'behind': 0.641, 'in': 0.533, 'to the right of': 0.691, 'to the left of': 0.713, 'on': 0.583, 'under': 0.55, 'next to': 0.518, 'in front of': 0.578}

Epoch #18
Training..
[0/84] Loss = 0.10, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.58
[50/84] Loss = 0.10, Forward time = 11.25, Backward time = 0.06, Data loading time = 14.91
Train, acc avg: 0.9733727734291099 acc: 0.9700710811821923, pre: 0.9697433896218176, rec: 0.9690011481056258, f1: 0.9693671268079694, loss: 0.10359384172729083, lr: 9.221639627510076e-05
{'to the left of': 0.964, 'behind': 0.966, 'in front of': 0.963, 'under': 0.961, 'above': 0.993, 'on': 0.986, 'to the right of': 0.979, 'in': 0.979, 'next to': 0.968}

Validating..
Valid, acc avg: 0.62908856370916 acc: 0.620049504950495, pre: 0.609480798883052, rec: 0.6683168316831684, f1: 0.6375392770205227, loss: 0.8644260764122009
{'above': 0.604, 'on': 0.602, 'behind': 0.622, 'in': 0.568, 'in front of': 0.549, 'to the right of': 0.667, 'to the left of': 0.815, 'next to': 0.562, 'under': 0.673}

Testing..
Test, acc avg: 0.6131199630980722 acc: 0.6124595469255664, pre: 0.6005788625097126, rec: 0.6715210355987055, f1: 0.634066821287861, loss: 0.9233106374740601
{'above': 0.66, 'behind': 0.62, 'in': 0.565, 'to the right of': 0.699, 'to the left of': 0.699, 'on': 0.598, 'under': 0.55, 'next to': 0.561, 'in front of': 0.566}

Epoch #19
Training..
[0/84] Loss = 0.06, Forward time = 0.23, Backward time = 0.00, Data loading time = 1.61
[50/84] Loss = 0.08, Forward time = 11.27, Backward time = 0.07, Data loading time = 14.78
Train, acc avg: 0.9773282523087629 acc: 0.974934530490086, pre: 0.9754507058862649, rec: 0.9732108687332568, f1: 0.9743245000814414, loss: 0.09224301975752626, lr: 9.135402871372808e-05
{'in front of': 0.961, 'under': 0.963, 'next to': 0.993, 'in': 0.983, 'behind': 0.983, 'to the right of': 0.975, 'to the left of': 0.977, 'above': 0.989, 'on': 0.973}

Validating..
Valid, acc avg: 0.6307185626460694 acc: 0.625, pre: 0.6166281612787954, rec: 0.6608910891089109, f1: 0.6379878299602021, loss: 0.872848629951477
{'above': 0.573, 'on': 0.619, 'behind': 0.646, 'in': 0.595, 'in front of': 0.549, 'to the right of': 0.683, 'to the left of': 0.759, 'next to': 0.55, 'under': 0.702}

Testing..
Test, acc avg: 0.6085984427818826 acc: 0.6076051779935275, pre: 0.5988112838215263, rec: 0.6521035598705501, f1: 0.6243172351076794, loss: 0.9263835549354553
{'above': 0.642, 'behind': 0.641, 'in': 0.554, 'to the right of': 0.699, 'to the left of': 0.684, 'on': 0.588, 'under': 0.579, 'next to': 0.561, 'in front of': 0.53}

Epoch #20
Training..
[0/84] Loss = 0.05, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.56
[50/84] Loss = 0.08, Forward time = 11.26, Backward time = 0.07, Data loading time = 14.92
Train, acc avg: 0.9779636884791972 acc: 0.9753086419753086, pre: 0.9747416725038588, rec: 0.9747416762342136, f1: 0.9747366743946838, loss: 0.08938126159565789, lr: 9.045084971874738e-05
{'to the right of': 0.966, 'under': 0.959, 'above': 0.981, 'in': 0.996, 'in front of': 0.979, 'next to': 0.988, 'on': 0.983, 'behind': 0.979, 'to the left of': 0.971}

Validating..
Valid, acc avg: 0.6325001846512687 acc: 0.6225247524752475, pre: 0.6159250441235353, rec: 0.650990099009901, f1: 0.6329673187556709, loss: 0.872794508934021
{'above': 0.615, 'on': 0.614, 'behind': 0.707, 'in': 0.622, 'in front of': 0.512, 'to the right of': 0.683, 'to the left of': 0.815, 'next to': 0.5, 'under': 0.625}

Testing..
Test, acc avg: 0.6150499086673862 acc: 0.6140776699029126, pre: 0.6056971423433712, rec: 0.6537216828478964, f1: 0.628788776735735, loss: 0.9213013052940369
{'above': 0.642, 'behind': 0.676, 'in': 0.598, 'to the right of': 0.654, 'to the left of': 0.669, 'on': 0.598, 'under': 0.55, 'next to': 0.57, 'in front of': 0.578}

Epoch #21
Training..
[0/84] Loss = 0.06, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.72
[50/84] Loss = 0.08, Forward time = 11.26, Backward time = 0.07, Data loading time = 15.51
Train, acc avg: 0.9819198431334679 acc: 0.9784885895997008, pre: 0.9767175535239787, rec: 0.9793340987370838, f1: 0.9780190761323028, loss: 0.07837721151078031, lr: 8.950775061878452e-05
{'under': 0.962, 'to the right of': 0.977, 'on': 0.979, 'next to': 0.997, 'to the left of': 0.975, 'in front of': 0.978, 'above': 0.996, 'behind': 0.978, 'in': 0.996}

Validating..
Valid, acc avg: 0.6369243694108193 acc: 0.6212871287128713, pre: 0.616113729475978, rec: 0.6435643564356436, f1: 0.6295349463663827, loss: 0.9370566010475159
{'above': 0.604, 'on': 0.574, 'behind': 0.695, 'in': 0.595, 'in front of': 0.561, 'to the right of': 0.717, 'to the left of': 0.815, 'next to': 0.537, 'under': 0.635}

Testing..
Test, acc avg: 0.6164651436613917 acc: 0.6124595469255664, pre: 0.6061068609754678, rec: 0.6423948220064725, f1: 0.6237184871883484, loss: 0.954155445098877
{'above': 0.651, 'behind': 0.648, 'in': 0.576, 'to the right of': 0.728, 'to the left of': 0.706, 'on': 0.52, 'under': 0.55, 'next to': 0.561, 'in front of': 0.608}

Epoch #22
Training..
[0/84] Loss = 0.08, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.68
[50/84] Loss = 0.07, Forward time = 11.26, Backward time = 0.07, Data loading time = 15.72
Train, acc avg: 0.9835226761495297 acc: 0.980546202768425, pre: 0.9830573701075958, rec: 0.9770378874856487, f1: 0.9800333859075233, loss: 0.07869193707371042, lr: 8.852566213878947e-05
{'next to': 0.996, 'in front of': 0.98, 'above': 0.993, 'behind': 0.973, 'under': 0.968, 'to the right of': 0.975, 'to the left of': 0.979, 'on': 0.988, 'in': 1.0}

Validating..
Valid, acc avg: 0.6323168445797172 acc: 0.6274752475247525, pre: 0.6178489561132963, rec: 0.6683168316831684, f1: 0.6420877468325269, loss: 0.9232003688812256
{'above': 0.604, 'on': 0.642, 'behind': 0.671, 'in': 0.622, 'in front of': 0.561, 'to the right of': 0.667, 'to the left of': 0.759, 'next to': 0.55, 'under': 0.615}

Testing..
Test, acc avg: 0.6090674452035916 acc: 0.6084142394822006, pre: 0.5991124171728932, rec: 0.6553398058252428, f1: 0.6259610021563144, loss: 0.9711300134658813
{'above': 0.642, 'behind': 0.655, 'in': 0.576, 'to the right of': 0.684, 'to the left of': 0.691, 'on': 0.578, 'under': 0.521, 'next to': 0.544, 'in front of': 0.59}

Epoch #23
Training..
[0/84] Loss = 0.04, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.69
[50/84] Loss = 0.07, Forward time = 11.28, Backward time = 0.08, Data loading time = 15.91
Train, acc avg: 0.9806073029597047 acc: 0.978675645342312, pre: 0.9752757665451662, rec: 0.9812476081132797, f1: 0.9782475735588737, loss: 0.07535901066980191, lr: 8.750555348152298e-05
{'on': 0.979, 'in front of': 0.975, 'under': 0.97, 'to the left of': 0.983, 'above': 0.981, 'next to': 0.995, 'behind': 0.973, 'to the right of': 0.973, 'in': 0.996}

Validating..
Valid, acc avg: 0.6255643165196011 acc: 0.620049504950495, pre: 0.6109839677120373, rec: 0.6608910891089109, f1: 0.6349533830652383, loss: 0.9407976865768433
{'above': 0.583, 'on': 0.619, 'behind': 0.659, 'in': 0.622, 'in front of': 0.537, 'to the right of': 0.7, 'to the left of': 0.722, 'next to': 0.525, 'under': 0.663}

Testing..
Test, acc avg: 0.6100936922591105 acc: 0.6092233009708737, pre: 0.6027397168532768, rec: 0.6407766990291263, f1: 0.6211714704346366, loss: 0.9724493622779846
{'above': 0.623, 'behind': 0.676, 'in': 0.533, 'to the right of': 0.684, 'to the left of': 0.684, 'on': 0.559, 'under': 0.564, 'next to': 0.596, 'in front of': 0.572}

Epoch #24
Training..
[0/84] Loss = 0.05, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.61
[50/84] Loss = 0.07, Forward time = 11.29, Backward time = 0.08, Data loading time = 15.61
Train, acc avg: 0.9825252246784232 acc: 0.9799850355405911, pre: 0.9797090314712518, rec: 0.9793340987370838, f1: 0.9795165292515018, loss: 0.07157719079848557, lr: 8.644843137107059e-05
{'to the right of': 0.971, 'on': 0.983, 'in front of': 0.983, 'behind': 0.982, 'to the left of': 0.983, 'under': 0.965, 'next to': 0.992, 'in': 0.992, 'above': 0.993}

Validating..
Valid, acc avg: 0.6297284651281941 acc: 0.620049504950495, pre: 0.6125289881083762, rec: 0.6534653465346535, f1: 0.6323303270357636, loss: 0.9249578714370728
{'above': 0.583, 'on': 0.602, 'behind': 0.659, 'in': 0.622, 'in front of': 0.537, 'to the right of': 0.683, 'to the left of': 0.796, 'next to': 0.512, 'under': 0.673}

Testing..
Test, acc avg: 0.6151903273402612 acc: 0.6173139158576052, pre: 0.6093514236900238, rec: 0.6537216828478964, f1: 0.6307522222069158, loss: 0.9612139463424683
{'above': 0.66, 'behind': 0.662, 'in': 0.533, 'to the right of': 0.64, 'to the left of': 0.728, 'on': 0.598, 'under': 0.579, 'next to': 0.535, 'in front of': 0.602}

Epoch #25
Training..
[0/84] Loss = 0.05, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.64
[50/84] Loss = 0.06, Forward time = 11.25, Backward time = 0.08, Data loading time = 15.44
Train, acc avg: 0.985051514563437 acc: 0.9820426487093153, pre: 0.9842246980214516, rec: 0.9789513968618446, f1: 0.9815759651774675, loss: 0.06622536041374717, lr: 8.535533905932738e-05
{'on': 0.99, 'next to': 0.989, 'in front of': 0.971, 'to the left of': 0.983, 'above': 0.993, 'under': 0.971, 'in': 0.996, 'behind': 0.982, 'to the right of': 0.992}

Validating..
Valid, acc avg: 0.6338370365978768 acc: 0.6287128712871287, pre: 0.6187214470611542, rec: 0.6707920792079208, f1: 0.6437004637293965, loss: 0.9415498375892639
{'above': 0.615, 'on': 0.642, 'behind': 0.671, 'in': 0.622, 'in front of': 0.524, 'to the right of': 0.65, 'to the left of': 0.815, 'next to': 0.512, 'under': 0.654}

Testing..
Test, acc avg: 0.6083394996924071 acc: 0.610032362459547, pre: 0.6033434558762393, rec: 0.6423948220064725, f1: 0.6222520533684865, loss: 0.9788867831230164
{'above': 0.623, 'behind': 0.648, 'in': 0.533, 'to the right of': 0.654, 'to the left of': 0.691, 'on': 0.578, 'under': 0.593, 'next to': 0.553, 'in front of': 0.602}

Epoch #26
Training..
[0/84] Loss = 0.05, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.66
[50/84] Loss = 0.06, Forward time = 11.27, Backward time = 0.09, Data loading time = 14.93
Train, acc avg: 0.9850835921227437 acc: 0.9824167601945379, pre: 0.9790794941837979, rec: 0.9850746268656716, f1: 0.9820629112088787, loss: 0.06524482812909853, lr: 8.422735529643444e-05
{'under': 0.976, 'next to': 0.989, 'on': 0.988, 'in front of': 0.978, 'in': 0.996, 'to the left of': 0.983, 'behind': 0.978, 'above': 1.0, 'to the right of': 0.979}

Validating..
Valid, acc avg: 0.6140930754413139 acc: 0.6064356435643564, pre: 0.5968468334043506, rec: 0.655940594059406, f1: 0.6249950037944998, loss: 0.9626675248146057
{'above': 0.562, 'on': 0.591, 'behind': 0.683, 'in': 0.595, 'in front of': 0.585, 'to the right of': 0.617, 'to the left of': 0.759, 'next to': 0.5, 'under': 0.635}

Testing..
Test, acc avg: 0.6073124899259611 acc: 0.6067961165048543, pre: 0.5976331272539478, rec: 0.6537216828478964, f1: 0.6244154071142615, loss: 0.9724841117858887
{'above': 0.623, 'behind': 0.662, 'in': 0.543, 'to the right of': 0.654, 'to the left of': 0.713, 'on': 0.549, 'under': 0.593, 'next to': 0.544, 'in front of': 0.584}

Epoch #27
Training..
[0/84] Loss = 0.04, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.54
[50/84] Loss = 0.06, Forward time = 11.25, Backward time = 0.06, Data loading time = 14.65
Train, acc avg: 0.9823058188220634 acc: 0.9814814814814815, pre: 0.9830899270442354, rec: 0.9789513968618446, f1: 0.9810112973036901, loss: 0.0630791877352056, lr: 8.306559326618259e-05
{'under': 0.977, 'behind': 0.982, 'in': 0.988, 'on': 0.988, 'in front of': 0.979, 'next to': 0.992, 'to the right of': 0.973, 'above': 0.989, 'to the left of': 0.975}

Validating..
Valid, acc avg: 0.6236779343825414 acc: 0.6175742574257426, pre: 0.6086956382449511, rec: 0.6584158415841584, f1: 0.6325752618094777, loss: 0.9483368396759033
{'above': 0.583, 'on': 0.631, 'behind': 0.683, 'in': 0.581, 'in front of': 0.5, 'to the right of': 0.667, 'to the left of': 0.796, 'next to': 0.537, 'under': 0.635}

Testing..
Test, acc avg: 0.6059683576201969 acc: 0.6067961165048543, pre: 0.5967741847980325, rec: 0.6585760517799353, f1: 0.6261488534953574, loss: 0.9953843951225281
{'above': 0.651, 'behind': 0.655, 'in': 0.543, 'to the right of': 0.647, 'to the left of': 0.699, 'on': 0.593, 'under': 0.564, 'next to': 0.535, 'in front of': 0.566}

Epoch #28
Training..
[0/84] Loss = 0.05, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.55
[50/84] Loss = 0.05, Forward time = 11.24, Backward time = 0.06, Data loading time = 15.21
Train, acc avg: 0.9846166165171605 acc: 0.9835390946502057, pre: 0.983901874343036, rec: 0.9823957137389974, f1: 0.9831432172188097, loss: 0.05960309864687068, lr: 8.18711994874345e-05
{'on': 0.99, 'to the right of': 0.977, 'behind': 0.986, 'next to': 0.996, 'under': 0.976, 'above': 0.985, 'in front of': 0.982, 'to the left of': 0.975, 'in': 0.996}

Validating..
Valid, acc avg: 0.6213274818965876 acc: 0.6113861386138614, pre: 0.6022727135847111, rec: 0.655940594059406, f1: 0.6279570870042497, loss: 0.9663015007972717
{'above': 0.562, 'on': 0.585, 'behind': 0.707, 'in': 0.527, 'in front of': 0.537, 'to the right of': 0.667, 'to the left of': 0.778, 'next to': 0.575, 'under': 0.654}

Testing..
Test, acc avg: 0.5833581053342743 acc: 0.5849514563106796, pre: 0.5768667558291837, rec: 0.6375404530744336, f1: 0.6056829402260309, loss: 1.0164631605148315
{'above': 0.613, 'behind': 0.662, 'in': 0.489, 'to the right of': 0.64, 'to the left of': 0.64, 'on': 0.539, 'under': 0.571, 'next to': 0.518, 'in front of': 0.578}

Epoch #29
Training..
[0/84] Loss = 0.09, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.62
[50/84] Loss = 0.05, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.98
Train, acc avg: 0.9860477503196443 acc: 0.9837261503928171, pre: 0.9831675555349366, rec: 0.9835438193647149, f1: 0.9833506514827408, loss: 0.05616241562668057, lr: 8.064535268264883e-05
{'under': 0.971, 'behind': 0.986, 'next to': 0.993, 'to the right of': 0.987, 'to the left of': 0.987, 'on': 0.983, 'in front of': 0.982, 'above': 0.989, 'in': 0.996}

Validating..
Valid, acc avg: 0.6260917480768429 acc: 0.6163366336633663, pre: 0.6063348279109768, rec: 0.6633663366336634, f1: 0.6335647425908197, loss: 0.9733214974403381
{'above': 0.562, 'on': 0.591, 'behind': 0.707, 'in': 0.554, 'in front of': 0.524, 'to the right of': 0.667, 'to the left of': 0.796, 'next to': 0.55, 'under': 0.683}

Testing..
Test, acc avg: 0.593741565541614 acc: 0.5946601941747572, pre: 0.5869242111898334, rec: 0.63915857605178, f1: 0.6119237417885302, loss: 1.018850564956665
{'above': 0.604, 'behind': 0.592, 'in': 0.565, 'to the right of': 0.669, 'to the left of': 0.662, 'on': 0.578, 'under': 0.557, 'next to': 0.526, 'in front of': 0.59}

Epoch #30
Training..
[0/84] Loss = 0.06, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.56
[50/84] Loss = 0.05, Forward time = 11.25, Backward time = 0.06, Data loading time = 14.61
Train, acc avg: 0.9846666443725626 acc: 0.9822297044519267, pre: 0.980901447742928, rec: 0.9827784156142365, f1: 0.981834034666163, loss: 0.06011807390799125, lr: 7.938926261462367e-05
{'next to': 0.989, 'behind': 0.982, 'to the left of': 0.981, 'on': 0.988, 'in front of': 0.978, 'under': 0.973, 'to the right of': 0.983, 'above': 0.993, 'in': 0.996}

Validating..
Valid, acc avg: 0.6195057866297703 acc: 0.6113861386138614, pre: 0.6041666526813275, rec: 0.6460396039603961, f1: 0.6243969120554739, loss: 0.983673095703125
{'above': 0.531, 'on': 0.608, 'behind': 0.695, 'in': 0.568, 'in front of': 0.537, 'to the right of': 0.683, 'to the left of': 0.778, 'next to': 0.512, 'under': 0.663}

Testing..
Test, acc avg: 0.6037511375712249 acc: 0.6059870550161812, pre: 0.5982008905816958, rec: 0.6456310679611651, f1: 0.6210066756294778, loss: 1.0325982570648193
{'above': 0.585, 'behind': 0.648, 'in': 0.554, 'to the right of': 0.684, 'to the left of': 0.662, 'on': 0.583, 'under': 0.571, 'next to': 0.544, 'in front of': 0.602}
Early stopping at 30 as val acc did not improve for 20 epochs.

Testing..
Checkpoint loaded from ./results/spatialsenseplus_RegionViT_seed0/model_best.pth
Best valid, acc: 0.6370314946534459
Best test, acc: 0.6198032016547427
Test at best valid, acc avg: 0.6157155940653847, acc: 0.6132686084142395, pre: 0.604790410107928, rec: 0.6537216828478964, f1: 0.6282998238631665, loss_test: 0.7606347799301147
{'above': 0.66, 'behind': 0.634, 'in': 0.609, 'to the right of': 0.676, 'to the left of': 0.691, 'on': 0.574, 'under': 0.557, 'next to': 0.544, 'in front of': 0.596}
| distributed init (rank 0)
DATALOADER:
  batch_size: 64
  crop: False
  data_aug_color: True
  data_aug_shift: True
  datapath: /seu_share/home/huangjie/220235144/spatial-relation-benchmark-main/data/spatialsense/annots_spatialsenseplus.json
  dataset_name: spatialsense
  load_img: True
  norm_data: True
  num_workers: 4
  object_dim: 3679
  predicate_dim: 9
  resize_mask: False
  trans_vec: []
EXP:
  EXP_ID: spatialsenseplus_RegionViT_seed1
  MODEL_NAME: regionvit
  OUTPUT_DIR: ./results
  SEED: 1
MODEL:
  CNNTRANSFORMER:
    backbone: resnet50
    pretrained_resnet: 
    prompt_emb_pool: max
    roi_pool_size: 3
    use_attn_mask: True
  CROSSATTNVIT:
    decoder_attn_drop_rate: 0.0
    decoder_depth: 1
    decoder_drop_rate: 0.0
    emb_pool: max-in-roi
  REGIONVIT:
    backbone: vit_base
    box_feature_size: 128
    hidden_dim: 512
    pretrain_ckp: ./data/pretrained_checkpoints/ibot_vit_base_patch16.pth
  RELATIVIT:
    prompt_emb_pool: max-in-roi
    use_attn_mask: True
  VISION_TRANSFORMER:
    depth: 12
    drop_path_rate: 0.0
    drop_rate: 0.0
    embed_dim: 768
    in_chans: 3
    num_heads: 12
    patch_size: 16
    pretrained: 
    readnet_d_hidden: 512
    readnet_dropout: 0.0
TRAIN:
  early_stop: 20
  l2: 0.0001
  layer_decay: 0.75
  learning_rate: 0.0001
  lr_decay_ratio: 0.5
  num_epochs: 100
  optimizer: adamw
  patience: 10
  scheduler: cosine
  warmup: 5
5346 relations in train
808 relations in valid
1236 relations in test
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding grid-size from %s to %s [14, 14] (14, 14)
Loading ViT pretrained weights from ./data/pretrained_checkpoints/ibot_vit_base_patch16.pth.
missing keys: []
unexpected keys: ['cls_token', 'masked_embed']
vit Backbone frozen!
Assigned values = [0.023757264018058777, 0.03167635202407837, 0.04223513603210449, 0.056313514709472656, 0.07508468627929688, 0.1001129150390625, 0.13348388671875, 0.177978515625, 0.2373046875, 0.31640625, 0.421875, 0.5625, 0.75, 1.0]
Param groups = {
  "layer_13_decay": {
    "weight_decay": 0.0001,
    "params": [
      "subject_feature_extractor.fc.0.weight",
      "rel_classifier.0.weight",
      "rel_classifier.3.weight"
    ],
    "lr_scale": 1.0
  },
  "layer_13_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "subject_feature_extractor.fc.0.bias",
      "subject_feature_extractor.fc.2.weight",
      "subject_feature_extractor.fc.2.bias",
      "rel_classifier.0.bias",
      "rel_classifier.2.weight",
      "rel_classifier.2.bias",
      "rel_classifier.3.bias"
    ],
    "lr_scale": 1.0
  }
}
DistributedDataParallel(
  (module): RegionViT(
    (backbone): VitModel(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
        (norm): Identity()
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (blocks): Sequential(
        (0): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (1): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (2): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (3): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (4): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (5): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (6): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (7): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (8): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (9): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (10): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (11): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (pre_logits): None
      (head): None
    )
    (subject_feature_extractor): RoiBoxFeatureExtractor(
      (pooler): RoIAlign(output_size=(3, 3), spatial_scale=0.0625, sampling_ratio=-1, aligned=False)
      (fc): Sequential(
        (0): Linear(in_features=6912, out_features=128, bias=True)
        (1): ReLU()
        (2): SyncBatchNorm(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (rel_classifier): Sequential(
      (0): Linear(in_features=128, out_features=512, bias=True)
      (1): ReLU()
      (2): SyncBatchNorm(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (3): Linear(in_features=512, out_features=9, bias=True)
    )
  )
)

Epoch #0
Training..
[0/84] Loss = 0.81, Forward time = 0.28, Backward time = 0.00, Data loading time = 2.42
[50/84] Loss = 0.73, Forward time = 11.20, Backward time = 0.08, Data loading time = 17.17
Train, acc avg: 0.4833994433043457 acc: 0.48110736999625886, pre: 0.4696798475718273, rec: 0.47722923842326825, f1: 0.473419448978391, loss: 0.7403939423106966, lr: 0
{'next to': 0.486, 'to the right of': 0.519, 'behind': 0.465, 'in front of': 0.479, 'above': 0.507, 'in': 0.471, 'under': 0.47, 'on': 0.514, 'to the left of': 0.439}

Validating..
Valid, acc avg: 0.4986137224788987 acc: 0.5061881188118812, pre: 0.5058547890900518, rec: 0.5346534653465347, f1: 0.5198505932903253, loss: 0.7320241332054138
{'above': 0.406, 'on': 0.545, 'behind': 0.524, 'in': 0.446, 'in front of': 0.549, 'to the right of': 0.533, 'to the left of': 0.407, 'next to': 0.537, 'under': 0.538}

Testing..
Test, acc avg: 0.4870377642475081 acc: 0.48462783171521034, pre: 0.4850863346140293, rec: 0.5, f1: 0.4924252761574745, loss: 0.7428271174430847
{'above': 0.538, 'behind': 0.451, 'in': 0.511, 'to the right of': 0.5, 'to the left of': 0.456, 'on': 0.49, 'under': 0.45, 'next to': 0.5, 'in front of': 0.488}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed1/model_best.pth

Epoch #1
Training..
[0/84] Loss = 0.76, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.61
[50/84] Loss = 0.71, Forward time = 11.17, Backward time = 0.07, Data loading time = 15.06
Train, acc avg: 0.5454147021013872 acc: 0.547699214365881, pre: 0.535236716533297, rec: 0.5667814772292384, f1: 0.5505526239366568, loss: 0.6991857701823825, lr: 2e-05
{'in front of': 0.556, 'to the left of': 0.548, 'behind': 0.492, 'under': 0.571, 'to the right of': 0.586, 'next to': 0.534, 'on': 0.557, 'above': 0.556, 'in': 0.508}

Validating..
Valid, acc avg: 0.5727898469090882 acc: 0.573019801980198, pre: 0.5654101870197298, rec: 0.6311881188118812, f1: 0.5964862362442569, loss: 0.695248007774353
{'above': 0.479, 'on': 0.585, 'behind': 0.622, 'in': 0.5, 'in front of': 0.524, 'to the right of': 0.617, 'to the left of': 0.63, 'next to': 0.525, 'under': 0.673}

Testing..
Test, acc avg: 0.5623816120258915 acc: 0.5614886731391586, pre: 0.5550724557235877, rec: 0.6197411003236246, f1: 0.5856219220303893, loss: 0.7041316032409668
{'above': 0.585, 'behind': 0.549, 'in': 0.511, 'to the right of': 0.61, 'to the left of': 0.647, 'on': 0.52, 'under': 0.586, 'next to': 0.518, 'in front of': 0.536}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed1/model_best.pth

Epoch #2
Training..
[0/84] Loss = 0.71, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.62
[50/84] Loss = 0.62, Forward time = 11.18, Backward time = 0.07, Data loading time = 15.08
Train, acc avg: 0.6663772760696631 acc: 0.6704077815188926, pre: 0.6478971127984111, rec: 0.7133562954458477, f1: 0.6790478336768798, loss: 0.6110354697420484, lr: 4e-05
{'to the right of': 0.739, 'under': 0.691, 'to the left of': 0.742, 'on': 0.639, 'in': 0.621, 'behind': 0.654, 'next to': 0.657, 'in front of': 0.635, 'above': 0.619}

Validating..
Valid, acc avg: 0.6074300868846939 acc: 0.599009900990099, pre: 0.5851063705296518, rec: 0.6806930693069307, f1: 0.6292856392006131, loss: 0.67479008436203
{'above': 0.531, 'on': 0.591, 'behind': 0.659, 'in': 0.527, 'in front of': 0.524, 'to the right of': 0.65, 'to the left of': 0.796, 'next to': 0.525, 'under': 0.663}

Testing..
Test, acc avg: 0.6005932946687833 acc: 0.6003236245954693, pre: 0.5883190799384747, rec: 0.6682847896440129, f1: 0.6257525913045549, loss: 0.6815349459648132
{'above': 0.623, 'behind': 0.577, 'in': 0.511, 'to the right of': 0.669, 'to the left of': 0.721, 'on': 0.539, 'under': 0.593, 'next to': 0.57, 'in front of': 0.602}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed1/model_best.pth

Epoch #3
Training..
[0/84] Loss = 0.52, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.61
[50/84] Loss = 0.54, Forward time = 11.23, Backward time = 0.07, Data loading time = 14.62
Train, acc avg: 0.7478842017164411 acc: 0.7437336326225215, pre: 0.7155740523219769, rec: 0.7895139686184462, f1: 0.7507228127721663, loss: 0.5420109033584595, lr: 6.000000000000001e-05
{'in': 0.75, 'on': 0.739, 'behind': 0.719, 'in front of': 0.704, 'to the left of': 0.769, 'next to': 0.749, 'above': 0.761, 'under': 0.747, 'to the right of': 0.794}

Validating..
Valid, acc avg: 0.6251081105078395 acc: 0.6163366336633663, pre: 0.6026200741786011, rec: 0.6831683168316832, f1: 0.6403662419302033, loss: 0.6709991693496704
{'above': 0.583, 'on': 0.625, 'behind': 0.61, 'in': 0.568, 'in front of': 0.585, 'to the right of': 0.7, 'to the left of': 0.796, 'next to': 0.562, 'under': 0.596}

Testing..
Test, acc avg: 0.6017205310663111 acc: 0.6011326860841424, pre: 0.5901875816711749, rec: 0.6618122977346278, f1: 0.6239461939479537, loss: 0.6818369030952454
{'above': 0.642, 'behind': 0.585, 'in': 0.511, 'to the right of': 0.699, 'to the left of': 0.75, 'on': 0.539, 'under': 0.571, 'next to': 0.535, 'in front of': 0.584}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed1/model_best.pth

Epoch #4
Training..
[0/84] Loss = 0.44, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.67
[50/84] Loss = 0.48, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.72
Train, acc avg: 0.8036517541413899 acc: 0.8026561915450804, pre: 0.7746826488903996, rec: 0.8407960199004975, f1: 0.8063814998597565, loss: 0.4778444263197127, lr: 8e-05
{'in front of': 0.77, 'under': 0.798, 'in': 0.792, 'to the left of': 0.832, 'on': 0.826, 'behind': 0.792, 'to the right of': 0.809, 'next to': 0.816, 'above': 0.799}

Validating..
Valid, acc avg: 0.6219465657643164 acc: 0.6113861386138614, pre: 0.6004464151686069, rec: 0.6658415841584159, f1: 0.631450405024067, loss: 0.6775844097137451
{'above': 0.635, 'on': 0.58, 'behind': 0.671, 'in': 0.568, 'in front of': 0.549, 'to the right of': 0.683, 'to the left of': 0.759, 'next to': 0.537, 'under': 0.615}

Testing..
Test, acc avg: 0.6257923556088947 acc: 0.6237864077669902, pre: 0.6082036689080104, rec: 0.6957928802588996, f1: 0.6490516214721374, loss: 0.6799923777580261
{'above': 0.67, 'behind': 0.62, 'in': 0.587, 'to the right of': 0.691, 'to the left of': 0.721, 'on': 0.569, 'under': 0.579, 'next to': 0.57, 'in front of': 0.627}

Epoch #5
Training..
[0/84] Loss = 0.34, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.71
[50/84] Loss = 0.41, Forward time = 11.22, Backward time = 0.07, Data loading time = 15.14
Train, acc avg: 0.8463104803490589 acc: 0.8359521137298915, pre: 0.8133573977857133, rec: 0.8622273249138921, f1: 0.8370746980651913, loss: 0.41892003019650775, lr: 9.938441702975689e-05
{'to the left of': 0.878, 'to the right of': 0.838, 'behind': 0.812, 'next to': 0.867, 'in front of': 0.809, 'in': 0.867, 'on': 0.835, 'under': 0.808, 'above': 0.903}

Validating..
Valid, acc avg: 0.6448023234777979 acc: 0.6311881188118812, pre: 0.6188340668422855, rec: 0.6831683168316832, f1: 0.6494067693116703, loss: 0.6754024028778076
{'above': 0.635, 'on': 0.585, 'behind': 0.61, 'in': 0.649, 'in front of': 0.549, 'to the right of': 0.7, 'to the left of': 0.815, 'next to': 0.588, 'under': 0.673}

Testing..
Test, acc avg: 0.6303674251471093 acc: 0.6302588996763754, pre: 0.6161616072703953, rec: 0.6909385113268608, f1: 0.6514061479702272, loss: 0.6865527033805847
{'above': 0.67, 'behind': 0.648, 'in': 0.576, 'to the right of': 0.713, 'to the left of': 0.676, 'on': 0.598, 'under': 0.607, 'next to': 0.57, 'in front of': 0.614}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed1/model_best.pth

Epoch #6
Training..
[0/84] Loss = 0.34, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.58
[50/84] Loss = 0.35, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.93
Train, acc avg: 0.8902852122741349 acc: 0.881406659184437, pre: 0.8663457946451469, rec: 0.8955223880597015, f1: 0.8806875100922569, loss: 0.3569650752913384, lr: 9.911436253643445e-05
{'in front of': 0.861, 'next to': 0.923, 'in': 0.929, 'behind': 0.847, 'under': 0.858, 'to the left of': 0.897, 'above': 0.925, 'on': 0.89, 'to the right of': 0.882}

Validating..
Valid, acc avg: 0.6414495416019808 acc: 0.625, pre: 0.6139954714673709, rec: 0.6732673267326733, f1: 0.642261827141575, loss: 0.6783140301704407
{'above': 0.615, 'on': 0.574, 'behind': 0.659, 'in': 0.581, 'in front of': 0.585, 'to the right of': 0.717, 'to the left of': 0.833, 'next to': 0.575, 'under': 0.635}

Testing..
Test, acc avg: 0.6134629167494006 acc: 0.6132686084142395, pre: 0.6029411676038063, rec: 0.6634304207119741, f1: 0.6317361467959326, loss: 0.7013575434684753
{'above': 0.698, 'behind': 0.634, 'in': 0.511, 'to the right of': 0.669, 'to the left of': 0.728, 'on': 0.569, 'under': 0.543, 'next to': 0.561, 'in front of': 0.608}

Epoch #7
Training..
[0/84] Loss = 0.31, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.62
[50/84] Loss = 0.30, Forward time = 11.24, Backward time = 0.08, Data loading time = 14.82
Train, acc avg: 0.9082224566353551 acc: 0.9004863449307894, pre: 0.8835237711628315, rec: 0.9173363949483353, f1: 0.9001076550008645, loss: 0.30791110332523075, lr: 9.879583809693738e-05
{'to the right of': 0.901, 'under': 0.879, 'to the left of': 0.914, 'in front of': 0.881, 'behind': 0.883, 'on': 0.912, 'next to': 0.924, 'above': 0.933, 'in': 0.946}

Validating..
Valid, acc avg: 0.6400692184736899 acc: 0.6262376237623762, pre: 0.6169724629134756, rec: 0.6658415841584159, f1: 0.6404711901466341, loss: 0.6935757994651794
{'above': 0.594, 'on': 0.585, 'behind': 0.683, 'in': 0.662, 'in front of': 0.598, 'to the right of': 0.683, 'to the left of': 0.778, 'next to': 0.562, 'under': 0.615}

Testing..
Test, acc avg: 0.6147141506199558 acc: 0.6148867313915858, pre: 0.6044117558174742, rec: 0.6650485436893204, f1: 0.6332769788332727, loss: 0.7340592741966248
{'above': 0.642, 'behind': 0.627, 'in': 0.533, 'to the right of': 0.684, 'to the left of': 0.728, 'on': 0.569, 'under': 0.579, 'next to': 0.57, 'in front of': 0.602}

Epoch #8
Training..
[0/84] Loss = 0.24, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.63
[50/84] Loss = 0.25, Forward time = 11.26, Backward time = 0.07, Data loading time = 14.86
Train, acc avg: 0.9292415940307145 acc: 0.9238683127572016, pre: 0.9162264116368813, rec: 0.9292001530807501, f1: 0.9226626785514915, loss: 0.26019295517887386, lr: 9.842915805643155e-05
{'in': 0.967, 'under': 0.898, 'behind': 0.919, 'in front of': 0.914, 'to the right of': 0.931, 'to the left of': 0.908, 'on': 0.926, 'above': 0.937, 'next to': 0.964}

Validating..
Valid, acc avg: 0.6347681415093339 acc: 0.6212871287128713, pre: 0.61722486561663, rec: 0.6386138613861386, f1: 0.6277322201308528, loss: 0.7194957137107849
{'above': 0.583, 'on': 0.58, 'behind': 0.72, 'in': 0.608, 'in front of': 0.622, 'to the right of': 0.667, 'to the left of': 0.796, 'next to': 0.512, 'under': 0.625}

Testing..
Test, acc avg: 0.6193802459999191 acc: 0.6189320388349514, pre: 0.6132511461748668, rec: 0.6440129449838188, f1: 0.6282507202527425, loss: 0.7454005479812622
{'above': 0.66, 'behind': 0.62, 'in': 0.543, 'to the right of': 0.706, 'to the left of': 0.713, 'on': 0.574, 'under': 0.55, 'next to': 0.588, 'in front of': 0.62}

Epoch #9
Training..
[0/84] Loss = 0.25, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.63
[50/84] Loss = 0.22, Forward time = 11.24, Backward time = 0.08, Data loading time = 14.76
Train, acc avg: 0.9385713155757328 acc: 0.934717545828657, pre: 0.9287878752697428, rec: 0.9383849980864907, f1: 0.933556772605927, loss: 0.23270219972445852, lr: 9.801468428384716e-05
{'under': 0.926, 'in front of': 0.917, 'in': 0.979, 'to the right of': 0.935, 'to the left of': 0.935, 'on': 0.931, 'next to': 0.964, 'above': 0.937, 'behind': 0.923}

Validating..
Valid, acc avg: 0.6154114449507404 acc: 0.6064356435643564, pre: 0.599999986046512, rec: 0.6386138613861386, f1: 0.6187000334524511, loss: 0.7386118769645691
{'above': 0.583, 'on': 0.585, 'behind': 0.659, 'in': 0.622, 'in front of': 0.549, 'to the right of': 0.7, 'to the left of': 0.704, 'next to': 0.512, 'under': 0.625}

Testing..
Test, acc avg: 0.6025316617507869 acc: 0.6019417475728155, pre: 0.595454536432507, rec: 0.6359223300970874, f1: 0.6150184748067399, loss: 0.7734112739562988
{'above': 0.642, 'behind': 0.592, 'in': 0.554, 'to the right of': 0.699, 'to the left of': 0.654, 'on': 0.574, 'under': 0.557, 'next to': 0.561, 'in front of': 0.59}

Epoch #10
Training..
[0/84] Loss = 0.24, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.64
[50/84] Loss = 0.20, Forward time = 11.27, Backward time = 0.07, Data loading time = 14.86
Train, acc avg: 0.9498327855387214 acc: 0.9442573887018332, pre: 0.9446792126597033, rec: 0.9410639112131649, f1: 0.9428630963967556, loss: 0.207423908192487, lr: 9.755282581475769e-05
{'in': 0.963, 'in front of': 0.916, 'behind': 0.949, 'next to': 0.975, 'to the left of': 0.937, 'under': 0.92, 'to the right of': 0.954, 'above': 0.978, 'on': 0.957}

Validating..
Valid, acc avg: 0.6302946459450526 acc: 0.625, pre: 0.6177156033166527, rec: 0.655940594059406, f1: 0.6362494987054382, loss: 0.7557676434516907
{'above': 0.583, 'on': 0.631, 'behind': 0.671, 'in': 0.649, 'in front of': 0.537, 'to the right of': 0.683, 'to the left of': 0.722, 'next to': 0.562, 'under': 0.635}

Testing..
Test, acc avg: 0.6101935882208522 acc: 0.61084142394822, pre: 0.6045801434415246, rec: 0.6407766990291263, f1: 0.6221473952919147, loss: 0.7842474579811096
{'above': 0.613, 'behind': 0.648, 'in': 0.533, 'to the right of': 0.691, 'to the left of': 0.684, 'on': 0.574, 'under': 0.571, 'next to': 0.588, 'in front of': 0.59}

Epoch #11
Training..
[0/84] Loss = 0.19, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.64
[50/84] Loss = 0.17, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.93
Train, acc avg: 0.9621042458317205 acc: 0.957351290684624, pre: 0.9577735087993339, rec: 0.9548411787217758, f1: 0.9563000959437876, loss: 0.17339389203559785, lr: 9.704403844771128e-05
{'behind': 0.956, 'on': 0.959, 'in front of': 0.944, 'to the left of': 0.958, 'next to': 0.975, 'in': 0.992, 'above': 0.978, 'under': 0.944, 'to the right of': 0.954}

Validating..
Valid, acc avg: 0.6355364244083757 acc: 0.6212871287128713, pre: 0.613425911726252, rec: 0.655940594059406, f1: 0.6339662899308351, loss: 0.757753849029541
{'above': 0.615, 'on': 0.591, 'behind': 0.671, 'in': 0.662, 'in front of': 0.524, 'to the right of': 0.683, 'to the left of': 0.833, 'next to': 0.525, 'under': 0.615}

Testing..
Test, acc avg: 0.6123234168000636 acc: 0.6132686084142395, pre: 0.6054216776291916, rec: 0.6504854368932039, f1: 0.6271400873886548, loss: 0.8043748736381531
{'above': 0.66, 'behind': 0.648, 'in': 0.543, 'to the right of': 0.684, 'to the left of': 0.662, 'on': 0.598, 'under': 0.579, 'next to': 0.553, 'in front of': 0.584}

Epoch #12
Training..
[0/84] Loss = 0.15, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.66
[50/84] Loss = 0.16, Forward time = 11.27, Backward time = 0.08, Data loading time = 14.28
Train, acc avg: 0.9574550138462425 acc: 0.9537972315750094, pre: 0.9536042908220693, rec: 0.9517795637198623, f1: 0.9526860535594784, loss: 0.1631134126690172, lr: 9.648882429441257e-05
{'next to': 0.978, 'under': 0.939, 'in front of': 0.934, 'behind': 0.959, 'above': 0.963, 'on': 0.966, 'to the right of': 0.947, 'in': 0.988, 'to the left of': 0.943}

Validating..
Valid, acc avg: 0.6238250954206239 acc: 0.6188118811881188, pre: 0.6076233047618094, rec: 0.6707920792079208, f1: 0.6376420635684326, loss: 0.7862576842308044
{'above': 0.594, 'on': 0.625, 'behind': 0.695, 'in': 0.608, 'in front of': 0.524, 'to the right of': 0.683, 'to the left of': 0.722, 'next to': 0.537, 'under': 0.625}

Testing..
Test, acc avg: 0.6096683694518549 acc: 0.6124595469255664, pre: 0.6054628132706705, rec: 0.6456310679611651, f1: 0.6248971146310077, loss: 0.8319193720817566
{'above': 0.66, 'behind': 0.627, 'in': 0.489, 'to the right of': 0.699, 'to the left of': 0.706, 'on': 0.603, 'under': 0.543, 'next to': 0.57, 'in front of': 0.59}

Epoch #13
Training..
[0/84] Loss = 0.22, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.67
[50/84] Loss = 0.14, Forward time = 11.25, Backward time = 0.07, Data loading time = 14.98
Train, acc avg: 0.9696564696075062 acc: 0.964272353161242, pre: 0.9646968497133658, rec: 0.9621125143513203, f1: 0.9633979489458411, loss: 0.1445574981293508, lr: 9.588773128419906e-05
{'behind': 0.949, 'to the right of': 0.973, 'above': 0.985, 'next to': 0.984, 'under': 0.948, 'in front of': 0.959, 'to the left of': 0.973, 'in': 0.996, 'on': 0.96}

Validating..
Valid, acc avg: 0.6222891051312461 acc: 0.6113861386138614, pre: 0.6046511487290431, rec: 0.6435643564356436, f1: 0.6234961964641773, loss: 0.7991772294044495
{'above': 0.615, 'on': 0.585, 'behind': 0.683, 'in': 0.662, 'in front of': 0.476, 'to the right of': 0.683, 'to the left of': 0.759, 'next to': 0.512, 'under': 0.625}

Testing..
Test, acc avg: 0.6151773436040415 acc: 0.616504854368932, pre: 0.6121495231752411, rec: 0.6359223300970874, f1: 0.623804520712762, loss: 0.8672979474067688
{'above': 0.623, 'behind': 0.627, 'in': 0.565, 'to the right of': 0.713, 'to the left of': 0.684, 'on': 0.603, 'under': 0.529, 'next to': 0.579, 'in front of': 0.614}

Epoch #14
Training..
[0/84] Loss = 0.13, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.67
[50/84] Loss = 0.13, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.83
Train, acc avg: 0.9680177652841587 acc: 0.9624017957351291, pre: 0.96491904022776, rec: 0.9579027937236892, f1: 0.9613931161644066, loss: 0.13553069860097908, lr: 9.524135262330098e-05
{'on': 0.979, 'next to': 0.985, 'to the left of': 0.964, 'under': 0.939, 'behind': 0.955, 'in front of': 0.955, 'in': 0.992, 'above': 0.989, 'to the right of': 0.954}

Validating..
Valid, acc avg: 0.6162441651432166 acc: 0.6138613861386139, pre: 0.6111110963499735, rec: 0.6262376237623762, f1: 0.6185769003159883, loss: 0.8146054148674011
{'above': 0.615, 'on': 0.631, 'behind': 0.695, 'in': 0.635, 'in front of': 0.488, 'to the right of': 0.667, 'to the left of': 0.704, 'next to': 0.487, 'under': 0.625}

Testing..
Test, acc avg: 0.613650235152133 acc: 0.6140776699029126, pre: 0.6120826611751564, rec: 0.6229773462783171, f1: 0.6174769521738771, loss: 0.8573148250579834
{'above': 0.642, 'behind': 0.627, 'in': 0.543, 'to the right of': 0.684, 'to the left of': 0.669, 'on': 0.574, 'under': 0.6, 'next to': 0.57, 'in front of': 0.614}

Epoch #15
Training..
[0/84] Loss = 0.19, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.60
[50/84] Loss = 0.12, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.72
Train, acc avg: 0.9718060250474747 acc: 0.9683875794986906, pre: 0.9681992300068994, rec: 0.9670876387294298, f1: 0.9676381151574047, loss: 0.12113219056101072, lr: 9.45503262094184e-05
{'to the right of': 0.96, 'on': 0.983, 'under': 0.948, 'next to': 0.982, 'above': 0.989, 'in': 0.975, 'behind': 0.966, 'to the left of': 0.973, 'in front of': 0.971}

Validating..
Valid, acc avg: 0.6181217596868003 acc: 0.6126237623762376, pre: 0.6031745894971748, rec: 0.6584158415841584, f1: 0.6295808009919088, loss: 0.8418987393379211
{'above': 0.583, 'on': 0.614, 'behind': 0.659, 'in': 0.608, 'in front of': 0.512, 'to the right of': 0.683, 'to the left of': 0.722, 'next to': 0.537, 'under': 0.644}

Testing..
Test, acc avg: 0.6168026237363804 acc: 0.6197411003236246, pre: 0.6145510740781568, rec: 0.6423948220064725, f1: 0.628159554485663, loss: 0.8840038776397705
{'above': 0.67, 'behind': 0.641, 'in': 0.5, 'to the right of': 0.684, 'to the left of': 0.728, 'on': 0.603, 'under': 0.55, 'next to': 0.561, 'in front of': 0.614}

Epoch #16
Training..
[0/84] Loss = 0.08, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.74
[50/84] Loss = 0.11, Forward time = 11.23, Backward time = 0.07, Data loading time = 17.88
Train, acc avg: 0.9750631057461125 acc: 0.9721286943509165, pre: 0.9716692152692602, rec: 0.9712973593570609, f1: 0.9714782517551355, loss: 0.11591580594401985, lr: 9.381533400219318e-05
{'next to': 0.982, 'in': 0.983, 'behind': 0.982, 'on': 0.979, 'in front of': 0.965, 'under': 0.956, 'to the left of': 0.975, 'above': 0.985, 'to the right of': 0.968}

Validating..
Valid, acc avg: 0.6077863094631387 acc: 0.6051980198019802, pre: 0.6039119656745241, rec: 0.6113861386138614, f1: 0.6076210690171445, loss: 0.8313825130462646
{'above': 0.594, 'on': 0.619, 'behind': 0.659, 'in': 0.595, 'in front of': 0.524, 'to the right of': 0.667, 'to the left of': 0.667, 'next to': 0.55, 'under': 0.596}

Testing..
Test, acc avg: 0.6107700858453986 acc: 0.6156957928802589, pre: 0.6094946307887499, rec: 0.6440129449838188, f1: 0.6262735197536715, loss: 0.8981946706771851
{'above': 0.632, 'behind': 0.641, 'in': 0.511, 'to the right of': 0.728, 'to the left of': 0.684, 'on': 0.618, 'under': 0.579, 'next to': 0.509, 'in front of': 0.596}

Epoch #17
Training..
[0/84] Loss = 0.10, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.90
[50/84] Loss = 0.10, Forward time = 11.23, Backward time = 0.07, Data loading time = 18.39
Train, acc avg: 0.974197759092631 acc: 0.9708193041526375, pre: 0.9701492500185639, rec: 0.9701492537313433, f1: 0.9701442519007226, loss: 0.10422653186001948, lr: 9.30371013501972e-05
{'in front of': 0.959, 'to the left of': 0.973, 'behind': 0.968, 'on': 0.983, 'above': 0.985, 'under': 0.956, 'in': 0.979, 'to the right of': 0.983, 'next to': 0.982}

Validating..
Valid, acc avg: 0.6116766296305591 acc: 0.6027227722772277, pre: 0.599999985542169, rec: 0.6163366336633663, f1: 0.6080536015772666, loss: 0.8467336893081665
{'above': 0.625, 'on': 0.58, 'behind': 0.659, 'in': 0.622, 'in front of': 0.512, 'to the right of': 0.683, 'to the left of': 0.704, 'next to': 0.525, 'under': 0.596}

Testing..
Test, acc avg: 0.6075327737410873 acc: 0.610032362459547, pre: 0.6033434558762393, rec: 0.6423948220064725, f1: 0.6222520533684865, loss: 0.9123008251190186
{'above': 0.642, 'behind': 0.634, 'in': 0.5, 'to the right of': 0.706, 'to the left of': 0.706, 'on': 0.588, 'under': 0.564, 'next to': 0.544, 'in front of': 0.584}

Epoch #18
Training..
[0/84] Loss = 0.08, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.89
[50/84] Loss = 0.09, Forward time = 11.22, Backward time = 0.07, Data loading time = 17.16
Train, acc avg: 0.9769765539664896 acc: 0.9725028058361391, pre: 0.9702517125467135, rec: 0.9735935706084959, f1: 0.9719147689575589, loss: 0.09737826821704705, lr: 9.221639627510076e-05
{'to the left of': 0.973, 'behind': 0.975, 'in front of': 0.969, 'under': 0.951, 'above': 0.989, 'on': 0.976, 'to the right of': 0.975, 'in': 0.996, 'next to': 0.99}

Validating..
Valid, acc avg: 0.6083712572703087 acc: 0.6039603960396039, pre: 0.5972222083976341, rec: 0.6386138613861386, f1: 0.617219878648965, loss: 0.8944608569145203
{'above': 0.573, 'on': 0.608, 'behind': 0.646, 'in': 0.622, 'in front of': 0.537, 'to the right of': 0.633, 'to the left of': 0.704, 'next to': 0.537, 'under': 0.615}

Testing..
Test, acc avg: 0.6111377332540658 acc: 0.6124595469255664, pre: 0.6041978919910361, rec: 0.6521035598705501, f1: 0.6272323565144825, loss: 0.9456321001052856
{'above': 0.679, 'behind': 0.627, 'in': 0.522, 'to the right of': 0.706, 'to the left of': 0.699, 'on': 0.583, 'under': 0.55, 'next to': 0.526, 'in front of': 0.608}

Epoch #19
Training..
[0/84] Loss = 0.07, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.90
[50/84] Loss = 0.09, Forward time = 11.24, Backward time = 0.08, Data loading time = 16.72
Train, acc avg: 0.9797087959005355 acc: 0.9756827534605312, pre: 0.9754883149157858, rec: 0.9747416762342136, f1: 0.9751098526773759, loss: 0.09060377880398716, lr: 9.135402871372808e-05
{'in front of': 0.972, 'under': 0.957, 'next to': 0.989, 'in': 0.996, 'behind': 0.976, 'to the right of': 0.971, 'to the left of': 0.981, 'above': 0.993, 'on': 0.983}

Validating..
Valid, acc avg: 0.599375944159142 acc: 0.5915841584158416, pre: 0.5885167323321356, rec: 0.6089108910891089, f1: 0.598535140196019, loss: 0.8950324058532715
{'above': 0.604, 'on': 0.585, 'behind': 0.634, 'in': 0.635, 'in front of': 0.463, 'to the right of': 0.667, 'to the left of': 0.704, 'next to': 0.525, 'under': 0.577}

Testing..
Test, acc avg: 0.6010889361252487 acc: 0.6011326860841424, pre: 0.5951293668930081, rec: 0.6326860841423948, f1: 0.6133283332417631, loss: 0.9426627159118652
{'above': 0.651, 'behind': 0.655, 'in': 0.533, 'to the right of': 0.669, 'to the left of': 0.721, 'on': 0.574, 'under': 0.557, 'next to': 0.509, 'in front of': 0.542}

Epoch #20
Training..
[0/84] Loss = 0.11, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.73
[50/84] Loss = 0.08, Forward time = 11.24, Backward time = 0.07, Data loading time = 16.77
Train, acc avg: 0.977615506259371 acc: 0.9741863075196409, pre: 0.9739563348373943, rec: 0.9732108687332568, f1: 0.9735784591122008, loss: 0.0885929415623347, lr: 9.045084971874738e-05
{'to the right of': 0.975, 'under': 0.963, 'above': 0.989, 'in': 0.996, 'in front of': 0.958, 'next to': 0.988, 'on': 0.983, 'behind': 0.978, 'to the left of': 0.971}

Validating..
Valid, acc avg: 0.603081295425469 acc: 0.6027227722772277, pre: 0.6024691209266884, rec: 0.6039603960396039, f1: 0.6032088368449574, loss: 0.9208232760429382
{'above': 0.583, 'on': 0.631, 'behind': 0.695, 'in': 0.622, 'in front of': 0.5, 'to the right of': 0.6, 'to the left of': 0.704, 'next to': 0.487, 'under': 0.606}

Testing..
Test, acc avg: 0.6040570500491599 acc: 0.6059870550161812, pre: 0.6012364667505956, rec: 0.6294498381877023, f1: 0.6150147606523969, loss: 0.9791853427886963
{'above': 0.66, 'behind': 0.648, 'in': 0.511, 'to the right of': 0.699, 'to the left of': 0.699, 'on': 0.583, 'under': 0.514, 'next to': 0.526, 'in front of': 0.596}

Epoch #21
Training..
[0/84] Loss = 0.07, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.74
[50/84] Loss = 0.09, Forward time = 11.24, Backward time = 0.08, Data loading time = 16.43
Train, acc avg: 0.9804888921684523 acc: 0.9766180321735878, pre: 0.9795682306107624, rec: 0.9724454649827784, f1: 0.9759888526445328, loss: 0.08834064989128992, lr: 8.950775061878452e-05
{'under': 0.958, 'to the right of': 0.983, 'on': 0.986, 'next to': 0.993, 'to the left of': 0.968, 'in front of': 0.976, 'above': 0.993, 'behind': 0.971, 'in': 0.996}

Validating..
Valid, acc avg: 0.6192542998776062 acc: 0.6150990099009901, pre: 0.6201550227350123, rec: 0.594059405940594, f1: 0.6068217961960665, loss: 0.9141055345535278
{'above': 0.583, 'on': 0.614, 'behind': 0.683, 'in': 0.622, 'in front of': 0.537, 'to the right of': 0.65, 'to the left of': 0.685, 'next to': 0.575, 'under': 0.625}

Testing..
Test, acc avg: 0.5988008894520684 acc: 0.6003236245954693, pre: 0.597484267335153, rec: 0.6148867313915858, f1: 0.6060556022990169, loss: 0.9998821020126343
{'above': 0.679, 'behind': 0.648, 'in': 0.522, 'to the right of': 0.691, 'to the left of': 0.699, 'on': 0.593, 'under': 0.5, 'next to': 0.491, 'in front of': 0.566}

Epoch #22
Training..
[0/84] Loss = 0.05, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.71
[50/84] Loss = 0.08, Forward time = 11.22, Backward time = 0.08, Data loading time = 16.10
Train, acc avg: 0.9799531876839763 acc: 0.9771791994014216, pre: 0.9777522018498188, rec: 0.9755070799846919, f1: 0.9766233506516898, loss: 0.07950612747420867, lr: 8.852566213878947e-05
{'next to': 0.992, 'in front of': 0.973, 'above': 0.989, 'behind': 0.971, 'under': 0.964, 'to the right of': 0.983, 'to the left of': 0.979, 'on': 0.981, 'in': 0.988}

Validating..
Valid, acc avg: 0.6112286159034127 acc: 0.6076732673267327, pre: 0.6009280603032933, rec: 0.6410891089108911, f1: 0.6203542792757594, loss: 0.9230952262878418
{'above': 0.583, 'on': 0.619, 'behind': 0.646, 'in': 0.676, 'in front of': 0.5, 'to the right of': 0.617, 'to the left of': 0.722, 'next to': 0.512, 'under': 0.625}

Testing..
Test, acc avg: 0.6005959657021139 acc: 0.5978964401294499, pre: 0.5915279789481396, rec: 0.6326860841423948, f1: 0.6114101690119883, loss: 0.998180627822876
{'above': 0.66, 'behind': 0.648, 'in': 0.565, 'to the right of': 0.654, 'to the left of': 0.699, 'on': 0.554, 'under': 0.536, 'next to': 0.535, 'in front of': 0.554}

Epoch #23
Training..
[0/84] Loss = 0.08, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.74
[50/84] Loss = 0.07, Forward time = 11.25, Backward time = 0.07, Data loading time = 15.83
Train, acc avg: 0.981678775342933 acc: 0.9790497568275346, pre: 0.9796701151527805, rec: 0.9774205893608878, f1: 0.9785390594602302, loss: 0.07420452327157061, lr: 8.750555348152298e-05
{'on': 0.981, 'in front of': 0.975, 'under': 0.972, 'to the left of': 0.981, 'above': 0.989, 'next to': 0.988, 'behind': 0.971, 'to the right of': 0.983, 'in': 0.996}

Validating..
Valid, acc avg: 0.6116322458632756 acc: 0.6039603960396039, pre: 0.6004784545340083, rec: 0.6212871287128713, f1: 0.6107005901688439, loss: 0.9258655309677124
{'above': 0.531, 'on': 0.602, 'behind': 0.683, 'in': 0.608, 'in front of': 0.476, 'to the right of': 0.667, 'to the left of': 0.741, 'next to': 0.562, 'under': 0.635}

Testing..
Test, acc avg: 0.6112148658704898 acc: 0.6084142394822006, pre: 0.6024464739687083, rec: 0.6375404530744336, f1: 0.6194918545209303, loss: 0.9969964623451233
{'above': 0.679, 'behind': 0.655, 'in': 0.576, 'to the right of': 0.662, 'to the left of': 0.699, 'on': 0.574, 'under': 0.55, 'next to': 0.553, 'in front of': 0.554}

Epoch #24
Training..
[0/84] Loss = 0.03, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.73
[50/84] Loss = 0.07, Forward time = 11.24, Backward time = 0.07, Data loading time = 15.74
Train, acc avg: 0.9835590807332005 acc: 0.9820426487093153, pre: 0.9834805955302319, rec: 0.979716800612323, f1: 0.9815900901864937, loss: 0.06662938965573198, lr: 8.644843137107059e-05
{'to the right of': 0.973, 'on': 0.985, 'in front of': 0.979, 'behind': 0.987, 'to the left of': 0.983, 'under': 0.973, 'next to': 0.992, 'in': 0.992, 'above': 0.989}

Validating..
Valid, acc avg: 0.6195683571361079 acc: 0.6101485148514851, pre: 0.6098765281511969, rec: 0.6113861386138614, f1: 0.6106254004116165, loss: 0.9364554286003113
{'above': 0.562, 'on': 0.602, 'behind': 0.72, 'in': 0.635, 'in front of': 0.5, 'to the right of': 0.667, 'to the left of': 0.759, 'next to': 0.525, 'under': 0.606}

Testing..
Test, acc avg: 0.6124510206313085 acc: 0.6092233009708737, pre: 0.6040061540214768, rec: 0.6343042071197411, f1: 0.6187795285364699, loss: 1.0181965827941895
{'above': 0.689, 'behind': 0.641, 'in': 0.565, 'to the right of': 0.669, 'to the left of': 0.713, 'on': 0.554, 'under': 0.586, 'next to': 0.535, 'in front of': 0.56}

Epoch #25
Training..
[0/84] Loss = 0.10, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.64
[50/84] Loss = 0.06, Forward time = 11.25, Backward time = 0.07, Data loading time = 14.35
Train, acc avg: 0.9854557188347349 acc: 0.9826038159371493, pre: 0.9823889702052488, rec: 0.9820130118637581, f1: 0.9821959550836245, loss: 0.06655087628002677, lr: 8.535533905932738e-05
{'on': 0.981, 'next to': 0.989, 'in front of': 0.979, 'to the left of': 0.983, 'above': 0.993, 'under': 0.973, 'in': 1.0, 'behind': 0.982, 'to the right of': 0.989}

Validating..
Valid, acc avg: 0.6154423780101286 acc: 0.6051980198019802, pre: 0.5999999858823533, rec: 0.6311881188118812, f1: 0.6151940308099976, loss: 0.9582763910293579
{'above': 0.562, 'on': 0.585, 'behind': 0.695, 'in': 0.662, 'in front of': 0.524, 'to the right of': 0.617, 'to the left of': 0.759, 'next to': 0.537, 'under': 0.596}

Testing..
Test, acc avg: 0.6112634106295852 acc: 0.6076051779935275, pre: 0.6043955949074475, rec: 0.6229773462783171, f1: 0.6135408130309988, loss: 1.0245221853256226
{'above': 0.708, 'behind': 0.634, 'in': 0.565, 'to the right of': 0.669, 'to the left of': 0.75, 'on': 0.549, 'under': 0.543, 'next to': 0.518, 'in front of': 0.566}

Epoch #26
Training..
[0/84] Loss = 0.03, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.66
[50/84] Loss = 0.06, Forward time = 11.24, Backward time = 0.08, Data loading time = 14.56
Train, acc avg: 0.9854049663046103 acc: 0.9837261503928171, pre: 0.9839080422072488, rec: 0.9827784156142365, f1: 0.9833379045200024, loss: 0.06132447391393639, lr: 8.422735529643444e-05
{'under': 0.98, 'next to': 0.992, 'on': 0.988, 'in front of': 0.973, 'in': 0.996, 'to the left of': 0.983, 'behind': 0.98, 'above': 0.989, 'to the right of': 0.987}

Validating..
Valid, acc avg: 0.6097171261127899 acc: 0.6002475247524752, pre: 0.5910112226739052, rec: 0.650990099009901, f1: 0.6195474190087885, loss: 0.9567512273788452
{'above': 0.562, 'on': 0.591, 'behind': 0.622, 'in': 0.635, 'in front of': 0.5, 'to the right of': 0.683, 'to the left of': 0.741, 'next to': 0.537, 'under': 0.615}

Testing..
Test, acc avg: 0.6176490018304341 acc: 0.6132686084142395, pre: 0.6023391724804215, rec: 0.6666666666666666, f1: 0.632867511866788, loss: 1.0153520107269287
{'above': 0.679, 'behind': 0.627, 'in': 0.576, 'to the right of': 0.699, 'to the left of': 0.743, 'on': 0.529, 'under': 0.557, 'next to': 0.553, 'in front of': 0.596}
Early stopping at 26 as val acc did not improve for 20 epochs.

Testing..
Checkpoint loaded from ./results/spatialsenseplus_RegionViT_seed1/model_best.pth
Best valid, acc: 0.6448023234777979
Best test, acc: 0.6303674251471093
Test at best valid, acc avg: 0.6303674251471093, acc: 0.6302588996763754, pre: 0.6161616072703953, rec: 0.6909385113268608, f1: 0.6514061479702272, loss_test: 0.6865527033805847
{'above': 0.67, 'behind': 0.648, 'in': 0.576, 'to the right of': 0.713, 'to the left of': 0.676, 'on': 0.598, 'under': 0.607, 'next to': 0.57, 'in front of': 0.614}
| distributed init (rank 0)
DATALOADER:
  batch_size: 64
  crop: False
  data_aug_color: True
  data_aug_shift: True
  datapath: /seu_share/home/huangjie/220235144/spatial-relation-benchmark-main/data/spatialsense/annots_spatialsenseplus.json
  dataset_name: spatialsense
  load_img: True
  norm_data: True
  num_workers: 4
  object_dim: 3679
  predicate_dim: 9
  resize_mask: False
  trans_vec: []
EXP:
  EXP_ID: spatialsenseplus_RegionViT_seed2
  MODEL_NAME: regionvit
  OUTPUT_DIR: ./results
  SEED: 2
MODEL:
  CNNTRANSFORMER:
    backbone: resnet50
    pretrained_resnet: 
    prompt_emb_pool: max
    roi_pool_size: 3
    use_attn_mask: True
  CROSSATTNVIT:
    decoder_attn_drop_rate: 0.0
    decoder_depth: 1
    decoder_drop_rate: 0.0
    emb_pool: max-in-roi
  REGIONVIT:
    backbone: vit_base
    box_feature_size: 128
    hidden_dim: 512
    pretrain_ckp: ./data/pretrained_checkpoints/ibot_vit_base_patch16.pth
  RELATIVIT:
    prompt_emb_pool: max-in-roi
    use_attn_mask: True
  VISION_TRANSFORMER:
    depth: 12
    drop_path_rate: 0.0
    drop_rate: 0.0
    embed_dim: 768
    in_chans: 3
    num_heads: 12
    patch_size: 16
    pretrained: 
    readnet_d_hidden: 512
    readnet_dropout: 0.0
TRAIN:
  early_stop: 20
  l2: 0.0001
  layer_decay: 0.75
  learning_rate: 0.0001
  lr_decay_ratio: 0.5
  num_epochs: 100
  optimizer: adamw
  patience: 10
  scheduler: cosine
  warmup: 5
5346 relations in train
808 relations in valid
1236 relations in test
Resized position embedding: %s to %s torch.Size([1, 197, 768]) torch.Size([1, 197, 768])
Position embedding grid-size from %s to %s [14, 14] (14, 14)
Loading ViT pretrained weights from ./data/pretrained_checkpoints/ibot_vit_base_patch16.pth.
missing keys: []
unexpected keys: ['cls_token', 'masked_embed']
vit Backbone frozen!
Assigned values = [0.023757264018058777, 0.03167635202407837, 0.04223513603210449, 0.056313514709472656, 0.07508468627929688, 0.1001129150390625, 0.13348388671875, 0.177978515625, 0.2373046875, 0.31640625, 0.421875, 0.5625, 0.75, 1.0]
Param groups = {
  "layer_13_decay": {
    "weight_decay": 0.0001,
    "params": [
      "subject_feature_extractor.fc.0.weight",
      "rel_classifier.0.weight",
      "rel_classifier.3.weight"
    ],
    "lr_scale": 1.0
  },
  "layer_13_no_decay": {
    "weight_decay": 0.0,
    "params": [
      "subject_feature_extractor.fc.0.bias",
      "subject_feature_extractor.fc.2.weight",
      "subject_feature_extractor.fc.2.bias",
      "rel_classifier.0.bias",
      "rel_classifier.2.weight",
      "rel_classifier.2.bias",
      "rel_classifier.3.bias"
    ],
    "lr_scale": 1.0
  }
}
DistributedDataParallel(
  (module): RegionViT(
    (backbone): VitModel(
      (patch_embed): PatchEmbed(
        (proj): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
        (norm): Identity()
      )
      (pos_drop): Dropout(p=0.0, inplace=False)
      (blocks): Sequential(
        (0): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (1): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (2): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (3): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (4): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (5): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (6): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (7): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (8): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (9): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (10): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
        (11): Block(
          (norm1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (attn): Attention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU()
            (drop1): Dropout(p=0.0, inplace=False)
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.0, inplace=False)
          )
        )
      )
      (norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
      (pre_logits): None
      (head): None
    )
    (subject_feature_extractor): RoiBoxFeatureExtractor(
      (pooler): RoIAlign(output_size=(3, 3), spatial_scale=0.0625, sampling_ratio=-1, aligned=False)
      (fc): Sequential(
        (0): Linear(in_features=6912, out_features=128, bias=True)
        (1): ReLU()
        (2): SyncBatchNorm(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
    )
    (rel_classifier): Sequential(
      (0): Linear(in_features=128, out_features=512, bias=True)
      (1): ReLU()
      (2): SyncBatchNorm(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (3): Linear(in_features=512, out_features=9, bias=True)
    )
  )
)

Epoch #0
Training..
[0/84] Loss = 0.67, Forward time = 0.28, Backward time = 0.00, Data loading time = 1.88
[50/84] Loss = 0.72, Forward time = 11.21, Backward time = 0.07, Data loading time = 14.71
Train, acc avg: 0.518075219454361 acc: 0.5104751215862326, pre: 0.499256503720236, rec: 0.5139686184462304, f1: 0.506500751609807, loss: 0.722018906048366, lr: 0
{'next to': 0.501, 'to the right of': 0.521, 'behind': 0.494, 'in front of': 0.513, 'above': 0.485, 'in': 0.596, 'under': 0.494, 'on': 0.502, 'to the left of': 0.557}

Validating..
Valid, acc avg: 0.4997252385802521 acc: 0.49876237623762376, pre: 0.4987893341697498, rec: 0.5099009900990099, f1: 0.5042789602122034, loss: 0.725298285484314
{'above': 0.438, 'on': 0.5, 'behind': 0.439, 'in': 0.662, 'in front of': 0.451, 'to the right of': 0.383, 'to the left of': 0.519, 'next to': 0.625, 'under': 0.481}

Testing..
Test, acc avg: 0.5028775315364012 acc: 0.5, pre: 0.49999999226006203, rec: 0.5226537216828478, f1: 0.5110709478261689, loss: 0.728082001209259
{'above': 0.538, 'behind': 0.472, 'in': 0.576, 'to the right of': 0.507, 'to the left of': 0.515, 'on': 0.505, 'under': 0.457, 'next to': 0.456, 'in front of': 0.5}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed2/model_best.pth

Epoch #1
Training..
[0/84] Loss = 0.76, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.57
[50/84] Loss = 0.70, Forward time = 11.18, Backward time = 0.07, Data loading time = 14.77
Train, acc avg: 0.5588606743558767 acc: 0.5598578376356154, pre: 0.5465616026269283, rec: 0.5840030616150019, f1: 0.564657354159538, loss: 0.6899809957969756, lr: 2e-05
{'in front of': 0.507, 'to the left of': 0.63, 'behind': 0.538, 'under': 0.596, 'to the right of': 0.595, 'next to': 0.548, 'on': 0.521, 'above': 0.507, 'in': 0.588}

Validating..
Valid, acc avg: 0.5764901190206069 acc: 0.5668316831683168, pre: 0.5592105140524011, rec: 0.6311881188118812, f1: 0.5930182672403411, loss: 0.6885120272636414
{'above': 0.51, 'on': 0.534, 'behind': 0.549, 'in': 0.649, 'in front of': 0.5, 'to the right of': 0.55, 'to the left of': 0.667, 'next to': 0.662, 'under': 0.567}

Testing..
Test, acc avg: 0.5580405469249995 acc: 0.5558252427184466, pre: 0.5508100066154639, rec: 0.6051779935275081, f1: 0.5767105039579534, loss: 0.6918294429779053
{'above': 0.557, 'behind': 0.521, 'in': 0.576, 'to the right of': 0.625, 'to the left of': 0.669, 'on': 0.525, 'under': 0.529, 'next to': 0.491, 'in front of': 0.53}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed2/model_best.pth

Epoch #2
Training..
[0/84] Loss = 0.61, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.60
[50/84] Loss = 0.62, Forward time = 11.19, Backward time = 0.07, Data loading time = 14.53
Train, acc avg: 0.670619165257983 acc: 0.6698466142910587, pre: 0.6442176848836133, rec: 0.7248373517030233, f1: 0.6821488068901415, loss: 0.6135005546467645, lr: 4e-05
{'to the right of': 0.704, 'under': 0.687, 'to the left of': 0.737, 'on': 0.686, 'in': 0.667, 'behind': 0.639, 'next to': 0.651, 'in front of': 0.624, 'above': 0.642}

Validating..
Valid, acc avg: 0.6066737546242966 acc: 0.5977722772277227, pre: 0.5838641064997006, rec: 0.6806930693069307, f1: 0.628566450742989, loss: 0.6757135391235352
{'above': 0.635, 'on': 0.568, 'behind': 0.61, 'in': 0.635, 'in front of': 0.5, 'to the right of': 0.633, 'to the left of': 0.741, 'next to': 0.512, 'under': 0.625}

Testing..
Test, acc avg: 0.6110119739622626 acc: 0.6092233009708737, pre: 0.5936199640274624, rec: 0.6925566343042071, f1: 0.6392780719001541, loss: 0.6751032471656799
{'above': 0.613, 'behind': 0.613, 'in': 0.63, 'to the right of': 0.647, 'to the left of': 0.75, 'on': 0.559, 'under': 0.543, 'next to': 0.518, 'in front of': 0.627}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed2/model_best.pth

Epoch #3
Training..
[0/84] Loss = 0.51, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.62
[50/84] Loss = 0.54, Forward time = 11.21, Backward time = 0.07, Data loading time = 15.08
Train, acc avg: 0.7503147101433112 acc: 0.745230078563412, pre: 0.7169614959522667, rec: 0.7910447761194029, f1: 0.7521784168451451, loss: 0.5372690622295652, lr: 6.000000000000001e-05
{'in': 0.758, 'on': 0.771, 'behind': 0.726, 'in front of': 0.705, 'to the left of': 0.777, 'next to': 0.761, 'above': 0.754, 'under': 0.731, 'to the right of': 0.769}

Validating..
Valid, acc avg: 0.6277053296023486 acc: 0.6225247524752475, pre: 0.6029105903760792, rec: 0.7178217821782178, f1: 0.655362262120634, loss: 0.6686534881591797
{'above': 0.688, 'on': 0.614, 'behind': 0.646, 'in': 0.662, 'in front of': 0.5, 'to the right of': 0.633, 'to the left of': 0.759, 'next to': 0.512, 'under': 0.635}

Testing..
Test, acc avg: 0.6212794416076577 acc: 0.6181229773462783, pre: 0.6079881566865658, rec: 0.6650485436893204, f1: 0.6352345724086429, loss: 0.6705573797225952
{'above': 0.689, 'behind': 0.627, 'in': 0.609, 'to the right of': 0.662, 'to the left of': 0.757, 'on': 0.588, 'under': 0.514, 'next to': 0.561, 'in front of': 0.584}
Accuracy has improved
Checkpoint saved to ./results/spatialsenseplus_RegionViT_seed2/model_best.pth

Epoch #4
Training..
[0/84] Loss = 0.43, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.60
[50/84] Loss = 0.47, Forward time = 11.21, Backward time = 0.06, Data loading time = 14.39
Train, acc avg: 0.8092205175686978 acc: 0.8037785260007482, pre: 0.7757404768133269, rec: 0.8419441255262151, f1: 0.8074826193291563, loss: 0.4740172354947953, lr: 8e-05
{'in front of': 0.781, 'under': 0.788, 'in': 0.854, 'to the left of': 0.819, 'on': 0.799, 'behind': 0.795, 'to the right of': 0.807, 'next to': 0.834, 'above': 0.806}

Validating..
Valid, acc avg: 0.6158520550796973 acc: 0.6064356435643564, pre: 0.5930735802365026, rec: 0.6782178217821783, f1: 0.6327894724348746, loss: 0.6741211414337158
{'above': 0.604, 'on': 0.591, 'behind': 0.634, 'in': 0.703, 'in front of': 0.463, 'to the right of': 0.617, 'to the left of': 0.778, 'next to': 0.537, 'under': 0.615}

Testing..
Test, acc avg: 0.6234447153266337 acc: 0.6173139158576052, pre: 0.604617595892964, rec: 0.6779935275080906, f1: 0.6392017239603102, loss: 0.6700301170349121
{'above': 0.689, 'behind': 0.634, 'in': 0.63, 'to the right of': 0.676, 'to the left of': 0.765, 'on': 0.529, 'under': 0.55, 'next to': 0.535, 'in front of': 0.602}

Epoch #5
Training..
[0/84] Loss = 0.40, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.63
[50/84] Loss = 0.41, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.49
Train, acc avg: 0.8447701794201149 acc: 0.8374485596707819, pre: 0.8125447999550365, rec: 0.8675851511672407, f1: 0.839158431567872, loss: 0.41773726329917, lr: 9.938441702975689e-05
{'to the left of': 0.863, 'to the right of': 0.834, 'behind': 0.802, 'next to': 0.872, 'in front of': 0.801, 'in': 0.858, 'on': 0.868, 'under': 0.82, 'above': 0.884}

Validating..
Valid, acc avg: 0.6128850380882901 acc: 0.6002475247524752, pre: 0.588621431321194, rec: 0.6658415841584159, f1: 0.624849831705078, loss: 0.6983535289764404
{'above': 0.625, 'on': 0.568, 'behind': 0.646, 'in': 0.649, 'in front of': 0.512, 'to the right of': 0.667, 'to the left of': 0.778, 'next to': 0.475, 'under': 0.596}

Testing..
Test, acc avg: 0.6437594634360996 acc: 0.6415857605177994, pre: 0.63001484947972, rec: 0.686084142394822, f1: 0.6568501550705919, loss: 0.6757764220237732
{'above': 0.679, 'behind': 0.648, 'in': 0.663, 'to the right of': 0.662, 'to the left of': 0.772, 'on': 0.627, 'under': 0.579, 'next to': 0.561, 'in front of': 0.602}

Epoch #6
Training..
[0/84] Loss = 0.36, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.60
[50/84] Loss = 0.34, Forward time = 11.24, Backward time = 0.08, Data loading time = 14.48
Train, acc avg: 0.8840796531369709 acc: 0.8784137673026562, pre: 0.8596555483339847, rec: 0.8978185993111366, f1: 0.8783177263128447, loss: 0.35174459946297465, lr: 9.911436253643445e-05
{'in front of': 0.843, 'next to': 0.913, 'in': 0.929, 'behind': 0.853, 'under': 0.868, 'to the left of': 0.895, 'above': 0.881, 'on': 0.887, 'to the right of': 0.889}

Validating..
Valid, acc avg: 0.6044839115130443 acc: 0.5878712871287128, pre: 0.5783664331486439, rec: 0.6485148514851485, f1: 0.6114302484581476, loss: 0.7193828225135803
{'above': 0.635, 'on': 0.545, 'behind': 0.585, 'in': 0.689, 'in front of': 0.439, 'to the right of': 0.667, 'to the left of': 0.815, 'next to': 0.487, 'under': 0.577}

Testing..
Test, acc avg: 0.6207270309288621 acc: 0.6173139158576052, pre: 0.6055312866734893, rec: 0.6731391585760518, f1: 0.6375429018519477, loss: 0.7011232972145081
{'above': 0.66, 'behind': 0.655, 'in': 0.62, 'to the right of': 0.676, 'to the left of': 0.757, 'on': 0.559, 'under': 0.557, 'next to': 0.518, 'in front of': 0.584}

Epoch #7
Training..
[0/84] Loss = 0.27, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.60
[50/84] Loss = 0.29, Forward time = 11.24, Backward time = 0.07, Data loading time = 14.42
Train, acc avg: 0.9201462808002938 acc: 0.9135802469135802, pre: 0.9008572459900959, rec: 0.9249904324531191, f1: 0.9127593496305689, loss: 0.2981613189691589, lr: 9.879583809693738e-05
{'to the right of': 0.922, 'under': 0.889, 'to the left of': 0.92, 'in front of': 0.889, 'behind': 0.904, 'on': 0.918, 'next to': 0.952, 'above': 0.933, 'in': 0.954}

Validating..
Valid, acc avg: 0.6176183292375705 acc: 0.6064356435643564, pre: 0.5922746654018313, rec: 0.6831683168316832, f1: 0.6344777767598453, loss: 0.72226881980896
{'above': 0.604, 'on': 0.585, 'behind': 0.622, 'in': 0.649, 'in front of': 0.524, 'to the right of': 0.65, 'to the left of': 0.796, 'next to': 0.512, 'under': 0.615}

Testing..
Test, acc avg: 0.6202582437833657 acc: 0.6197411003236246, pre: 0.6051136277682724, rec: 0.6893203883495146, f1: 0.644473079862967, loss: 0.7128713130950928
{'above': 0.613, 'behind': 0.634, 'in': 0.63, 'to the right of': 0.662, 'to the left of': 0.779, 'on': 0.588, 'under': 0.564, 'next to': 0.509, 'in front of': 0.602}

Epoch #8
Training..
[0/84] Loss = 0.23, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.59
[50/84] Loss = 0.26, Forward time = 11.26, Backward time = 0.07, Data loading time = 14.51
Train, acc avg: 0.9309475730499942 acc: 0.923494201271979, pre: 0.9133533349086521, rec: 0.9318790662074244, f1: 0.9225182039360371, loss: 0.25822444206901957, lr: 9.842915805643155e-05
{'in': 0.971, 'under': 0.901, 'behind': 0.91, 'in front of': 0.916, 'to the right of': 0.914, 'to the left of': 0.929, 'on': 0.933, 'above': 0.959, 'next to': 0.946}

Validating..
Valid, acc avg: 0.6052177805565341 acc: 0.5977722772277227, pre: 0.5887640317131678, rec: 0.6485148514851485, f1: 0.6171917064336263, loss: 0.7493798136711121
{'above': 0.583, 'on': 0.614, 'behind': 0.622, 'in': 0.595, 'in front of': 0.476, 'to the right of': 0.65, 'to the left of': 0.796, 'next to': 0.525, 'under': 0.587}

Testing..
Test, acc avg: 0.6185241545677853 acc: 0.6197411003236246, pre: 0.6088235204584777, rec: 0.6699029126213593, f1: 0.6378994749452953, loss: 0.7375205159187317
{'above': 0.594, 'behind': 0.606, 'in': 0.641, 'to the right of': 0.625, 'to the left of': 0.706, 'on': 0.603, 'under': 0.564, 'next to': 0.553, 'in front of': 0.675}

Epoch #9
Training..
[0/84] Loss = 0.22, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.60
[50/84] Loss = 0.21, Forward time = 11.26, Backward time = 0.07, Data loading time = 14.40
Train, acc avg: 0.9413264602189313 acc: 0.9350916573138796, pre: 0.9311263282681645, rec: 0.9364714887102947, f1: 0.9337862594957171, loss: 0.22541008641322455, lr: 9.801468428384716e-05
{'under': 0.918, 'in front of': 0.912, 'in': 0.983, 'to the right of': 0.926, 'to the left of': 0.958, 'on': 0.942, 'next to': 0.959, 'above': 0.948, 'behind': 0.927}

Validating..
Valid, acc avg: 0.6205031651508617 acc: 0.6076732673267327, pre: 0.5956043825141895, rec: 0.6707920792079208, f1: 0.6309612501325215, loss: 0.7496050596237183
{'above': 0.604, 'on': 0.58, 'behind': 0.585, 'in': 0.595, 'in front of': 0.573, 'to the right of': 0.633, 'to the left of': 0.852, 'next to': 0.537, 'under': 0.625}

Testing..
Test, acc avg: 0.6066056404324761 acc: 0.6076051779935275, pre: 0.5979381355237389, rec: 0.656957928802589, f1: 0.626055145054439, loss: 0.7603601217269897
{'above': 0.623, 'behind': 0.556, 'in': 0.587, 'to the right of': 0.669, 'to the left of': 0.728, 'on': 0.613, 'under': 0.564, 'next to': 0.535, 'in front of': 0.584}

Epoch #10
Training..
[0/84] Loss = 0.22, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.59
[50/84] Loss = 0.20, Forward time = 11.23, Backward time = 0.07, Data loading time = 14.76
Train, acc avg: 0.9482874424445797 acc: 0.9427609427609428, pre: 0.9394285678497959, rec: 0.9437428243398392, f1: 0.9415757542689427, loss: 0.20035253571612494, lr: 9.755282581475769e-05
{'in': 0.971, 'in front of': 0.93, 'behind': 0.93, 'next to': 0.977, 'to the left of': 0.933, 'under': 0.918, 'to the right of': 0.96, 'above': 0.963, 'on': 0.954}

Validating..
Valid, acc avg: 0.6226024898958503 acc: 0.6150990099009901, pre: 0.6017505338785442, rec: 0.6806930693069307, f1: 0.6387871137723037, loss: 0.7773731350898743
{'above': 0.573, 'on': 0.614, 'behind': 0.671, 'in': 0.635, 'in front of': 0.61, 'to the right of': 0.633, 'to the left of': 0.759, 'next to': 0.512, 'under': 0.596}

Testing..
Test, acc avg: 0.6098410724411363 acc: 0.610032362459547, pre: 0.5991253556978812, rec: 0.6650485436893204, f1: 0.6303631069615184, loss: 0.767590343952179
{'above': 0.604, 'behind': 0.592, 'in': 0.609, 'to the right of': 0.713, 'to the left of': 0.713, 'on': 0.603, 'under': 0.536, 'next to': 0.535, 'in front of': 0.584}

Epoch #11
Training..
[0/84] Loss = 0.12, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.63
[50/84] Loss = 0.17, Forward time = 11.22, Backward time = 0.06, Data loading time = 15.41
Train, acc avg: 0.9614550767446988 acc: 0.9575383464272353, pre: 0.9549961824752242, rec: 0.9582854955989284, f1: 0.95663301158506, loss: 0.17076280837257704, lr: 9.704403844771128e-05
{'behind': 0.952, 'on': 0.955, 'in front of': 0.948, 'to the left of': 0.96, 'next to': 0.981, 'in': 0.979, 'above': 0.981, 'under': 0.944, 'to the right of': 0.952}

Validating..
Valid, acc avg: 0.6091290867544255 acc: 0.6002475247524752, pre: 0.5939675036202435, rec: 0.6336633663366337, f1: 0.6131686506197711, loss: 0.7939985394477844
{'above': 0.594, 'on': 0.568, 'behind': 0.707, 'in': 0.554, 'in front of': 0.549, 'to the right of': 0.567, 'to the left of': 0.796, 'next to': 0.512, 'under': 0.635}

Testing..
Test, acc avg: 0.6248383845557722 acc: 0.622168284789644, pre: 0.6125186197836272, rec: 0.6650485436893204, f1: 0.6376986497822908, loss: 0.8098434209823608
{'above': 0.67, 'behind': 0.606, 'in': 0.598, 'to the right of': 0.706, 'to the left of': 0.765, 'on': 0.578, 'under': 0.564, 'next to': 0.553, 'in front of': 0.584}

Epoch #12
Training..
[0/84] Loss = 0.16, Forward time = 0.22, Backward time = 0.00, Data loading time = 1.63
[50/84] Loss = 0.15, Forward time = 11.25, Backward time = 0.07, Data loading time = 14.45
Train, acc avg: 0.9611223654711127 acc: 0.9577254021698466, pre: 0.9550133398588893, rec: 0.9586681974741676, f1: 0.956832278583637, loss: 0.1544774030113504, lr: 9.648882429441257e-05
{'next to': 0.973, 'under': 0.942, 'in front of': 0.951, 'behind': 0.959, 'above': 0.966, 'on': 0.973, 'to the right of': 0.954, 'in': 0.983, 'to the left of': 0.95}

Validating..
Valid, acc avg: 0.6113214035808887 acc: 0.6039603960396039, pre: 0.5921052501731305, rec: 0.6683168316831684, f1: 0.6279019877626242, loss: 0.8161599636077881
{'above': 0.615, 'on': 0.608, 'behind': 0.659, 'in': 0.622, 'in front of': 0.512, 'to the right of': 0.617, 'to the left of': 0.796, 'next to': 0.487, 'under': 0.587}

Testing..
